{
  "hash": "cecc9ae69382147da1891d38d1820182",
  "result": {
    "markdown": "---\ntitle: \"Lecture 05 figures\"\neditor: source\nfreeze: auto\nauthor:\n  - name: An Bui\n    url: https://an-bui.com/\n    affiliation: UC Santa Barbara, Ecology, Evolution, and Marine Biology\n    affiliation-url: https://www.eemb.ucsb.edu/\ndate: 2023-05-01\ncategories: [t-test, welch, student, paired, F-test]\ncitation:\n  url: https://an-bui.github.io/ES-193DS-W23/lecture/lecture-05_2023-05-01.html\n---\n\n\ntest statistic for unequal variances (welch's)\n\n$$\nt_s = \\frac{\\bar{x}_A - \\bar{x}_B}{\\sqrt{\\frac{s^2_A}{n_A} + \\frac{s^2_B}{n_B}}}\n$$\n\ndegrees of freedom for unequal variances (welch's)\n\n$$\ndf = \\frac{(\\frac{s^2_A}{n_A} + \\frac{s^2_B}{n_B})^2}{\\frac{(s^2_A/n_A)^2}{n_A - 1} + \\frac{(s^2_B/n_B)^2}{n_B - 1}}\n$$\n\ntest statistic for equal variances (student's t)\n\n$$\nt_s = \\frac{\\bar{x}_A - \\bar{x}_B}{s_p\\sqrt{\\frac{1}{n_A} + \\frac{1}{n_B}}}\n$$\n\n\ntest statistic for paired t-test\n\n$$\nt_s = \\frac{\\bar{x}_d - \\mu_0}{s_d - \\sqrt{n}}\n$$\n\ntest statistic for F test\n$$\nF =  \\frac{s^2_A}{s^2_B}\n$$\n\ndifferences in variances\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(patchwork)\n\nsmall <- ggplot(data.frame(x = -6:9), aes(x)) +\n  stat_function(geom = \"line\", n = 100, fun = dnorm, args = list(mean = 0, sd = 2), linewidth = 2, color = \"#FF6B2B\") +\n  geom_vline(aes(xintercept = 0), color = \"#FF6B2B\", lty = 2, linewidth = 2) +\n  stat_function(geom = \"line\", n = 100, fun = dnorm, args = list(mean = 3, sd = 2), linewidth = 2, color = \"#00A38D\") +\n  geom_vline(aes(xintercept = 3), color = \"#00A38D\", lty = 2, linewidth = 2) +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 0.21)) +\n  theme_void() +\n  theme(plot.margin = unit(c(1, 1, 1, 1), \"cm\"))\n\nbig <- ggplot(data.frame(x = -6:9), aes(x)) +\n  stat_function(geom = \"line\", n = 100, fun = dnorm, args = list(mean = 0, sd = 0.5), linewidth = 2, color = \"#FF6B2B\") +\n  geom_vline(aes(xintercept = 0), color = \"#FF6B2B\", lty = 2, linewidth = 2) +\n  stat_function(geom = \"line\", n = 100, fun = dnorm, args = list(mean = 3, sd = 0.5), linewidth = 2, color = \"#00A38D\") +\n  geom_vline(aes(xintercept = 3), color = \"#00A38D\", lty = 2, linewidth = 2) +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 0.8)) +\n  theme_void() +\n  theme(plot.margin = unit(c(1, 1, 1, 1), \"cm\"))\n\nunequal <- ggplot(data.frame(x = -6:9), aes(x)) +\n  stat_function(geom = \"line\", n = 100, fun = dnorm, args = list(mean = 0, sd = 2), linewidth = 2, color = \"#FF6B2B\") +\n  geom_vline(aes(xintercept = 0), color = \"#FF6B2B\", lty = 2, linewidth = 2) +\n  stat_function(geom = \"line\", n = 100, fun = dnorm, args = list(mean = 3, sd = 0.5), linewidth = 2, color = \"#00A38D\") +\n  geom_vline(aes(xintercept = 3), color = \"#00A38D\", lty = 2, linewidth = 2) +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 0.8)) +\n  theme_void() +\n  theme(plot.margin = unit(c(1, 1, 1, 1), \"cm\"))\n\nsmall/big/unequal\n```\n\n::: {.cell-output-display}\n![](lecture-05_2023-05-01_files/figure-html/unnamed-chunk-1-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\ndemonstration of power analysis:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pwr)\n\npwr.t.test(n = NULL, d = 0.5, sig.level = 0.05, power = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Two-sample t test power calculation \n\n              n = 104.9279\n              d = 0.5\n      sig.level = 0.05\n          power = 0.95\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n:::\n\n```{.r .cell-code}\npwr.t.test(n = NULL, d = 0.7, sig.level = 0.05, power = 0.80)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Two-sample t test power calculation \n\n              n = 33.02457\n              d = 0.7\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n:::\n:::\n\n\n\nU statistic:\n$$\n\\begin{align}\nU_1 &= \\Sigma R_1 - n_1(n_1 + 1)/2 = 17 - 5(5+1)/2 = 2 \\\\\nU_2 &= \\Sigma R_2 - n_2(n_2 + 1)/2 = 38 - 5(5+1)/2 = 23\n\\end{align}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSample1 <- c(1.1, 2.4, 1.8, 0.4, 1.6)\nSample2 <- c(5.4, 3.1, 2.3, 1.9, 4.2)\nwilcox.test(Sample1, Sample2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  Sample1 and Sample2\nW = 2, p-value = 0.03175\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# for a comparison of one group against a theoretical median\nwilcox.test(SampleA, mu = theoretical)\n\n# for a comparison of two groups\nwilcox.test(SampleA, SampleB, paired = TRUE)\n```\n:::\n\n\n\nbalanced design using Student's t:\n\n$$\n\\begin{align}\nSE_{\\bar{x}_A-\\bar{x}_B} &= s_p\\sqrt{\\frac{1}{n_A} + \\frac{1}{n_B}} \\\\\nScenario 1 &: s_p\\sqrt{\\frac{1}{5} + \\frac{1}{25}} = s_p*0.49 \\\\\nScenario 2 &: s_p\\sqrt{\\frac{1}{15} + \\frac{1}{15}} = s_p*0.37\n\\end{align}\n$$\n\n\n\n\n",
    "supporting": [
      "lecture-05_2023-05-01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}