{
  "hash": "2bada6da4ede9b3eda654489a25b5435",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 7 figures - Lectures 12 and 13\"\ndate: 2025-05-12\ncategories: [linear models]\ncitation:\n  url: https://spring-2025.envs-193ds.com/lecture/lecture_week-07.html\n---\n\n\n## 0. Set up\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# cleaning\nlibrary(tidyverse)\n\n# visualization\ntheme_set(theme_classic() +\n            theme(panel.grid = element_blank(),\n                  axis.text = element_text(size = 18),\n                  axis.title = element_text(size = 18),\n                  text = element_text(family = \"Lato\")))\nlibrary(patchwork)\nlibrary(ggeffects)\nlibrary(flextable)\nlibrary(modelsummary)\nlibrary(gtsummary)\nlibrary(readxl)\nlibrary(here)\nlibrary(janitor)\n\n# analysis\nlibrary(car)\nlibrary(performance)\nlibrary(broom)\n```\n:::\n\n\n## 1. Math\n\n### a. Residuals\n\nResiduals are the difference between the actual observed value ($y_i$) and the model prediction ($\\hat{y}$) at some value of $x$.\n\n$$\nresidual = y_i - \\hat{y}\n$$\n\nOrdinary least squares minimizes the sum of squares of the residuals.\n\n### b. Model equations\n\nOLS gives you an equation for a line.\n\n$$\n\\begin{align}\ny &= b + mx \\\\\n\ny &= \\beta_0 + \\beta_1x + \\epsilon \\\\\n\n\\end{align}\n$$\n$\\beta$ terms (\"betas\") are often referred to as \"model coefficients\". \n\n### c. Mathematical hypothesis\n\nStatistically, the hypotheses are:  \n\nH_0_: the predictor variable does not predict the response  \nH_A_: the predictor variable does predict the response  \n\nMathematically, you might express that as:\n\n$$\nH_0: \\beta_1 = 0  \\\\\nH_A: \\beta_1 \\neq 0\n$$\n\n### d. R2\n\n$$\n\\begin{align}\nR^2 &= 1 - \\frac{\\sum_{i = 1}^{n}(y_i - \\hat{y})^2}{\\sum_{i = 1}^{n}(y_i - \\bar{y})^2} \\\\\n&= 1 - \\frac{SS_{residuals}}{SS_{total}} \n\\end{align}\n$$\n\n### e. Pearson's correlation\n\n## formula for Pearson's correlation\n\n$$\nr = \\frac{\\sum(x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum(x_i-\\bar{x})^2}\\sqrt{\\sum(y_i - \\bar{y})^2}}\n$$\n\n\n## test statistic for pearson correlation\n\n$$\n\\begin{align}\nt &= \\frac{r\\sqrt{n - 2}}{\\sqrt{1-r^2}} \\\\\ndf &= n -2\n\\end{align}\n$$\n\n## 2. R2\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- tibble(\n  x = seq(from = 1, to = 20, by = 1),\n  r2_1 = 3*x + 1,\n  r2_between = runif(n = 20, min = 1, max = 5)*x + runif(n = 20, min = 1, max = 5),\n  r2_0 = runif(n = 20, min = 1, max = 20)\n)\n\nlm(r2_1 ~ x, data = df) |> \n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = r2_1 ~ x, data = df)\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-3.676e-15 -1.312e-15 -5.240e-17  8.432e-16  7.220e-15 \n\nCoefficients:\n             Estimate Std. Error   t value Pr(>|t|)    \n(Intercept) 1.000e+00  1.142e-15 8.757e+14   <2e-16 ***\nx           3.000e+00  9.532e-17 3.147e+16   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.458e-15 on 18 degrees of freedom\nMultiple R-squared:      1,\tAdjusted R-squared:      1 \nF-statistic: 9.905e+32 on 1 and 18 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(df,\n       aes(x = x,\n           y = r2_1)) +\n  geom_point(size = 3) +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/r2-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlm(r2_between ~ x, data = df) |> \n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = r2_between ~ x, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19.2658  -7.2799   0.0057   6.1424  27.2795 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   6.4962     5.4662   1.188     0.25    \nx             2.4284     0.4563   5.322 4.65e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.77 on 18 degrees of freedom\nMultiple R-squared:  0.6114,\tAdjusted R-squared:  0.5898 \nF-statistic: 28.32 on 1 and 18 DF,  p-value: 4.652e-05\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(df,\n       aes(x = x,\n           y = r2_between)) +\n  geom_point(size = 3) +\n  geom_smooth(method = \"lm\",\n              se = FALSE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/r2-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nlm(r2_0 ~ x, data = df) |> \n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = r2_0 ~ x, data = df)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.048 -4.754 -1.079  5.320 12.303 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept)   5.9353     2.9148   2.036   0.0567 .\nx             0.2742     0.2433   1.127   0.2746  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.275 on 18 degrees of freedom\nMultiple R-squared:  0.0659,\tAdjusted R-squared:  0.01401 \nF-statistic:  1.27 on 1 and 18 DF,  p-value: 0.2746\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(df,\n       aes(x = x,\n           y = r2_0)) +\n  geom_point(size = 3) +\n  geom_smooth(method = \"lm\",\n              se = FALSE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/r2-1-3.png){width=672}\n:::\n:::\n\n\n\n## 3. Red abalone example\n\nThis example is inspired in by Hamilton et al. 2022.  \n\nWe work with the linear model using the real data in class, but it's hard to see the difference in diagnostic plots between a \"good\" vs \"bad\" linear model with that data set. \n\nThis is the fake data generated to compare different diagnostic plots.\n\n### a. generating the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\nabalone <- tibble(\n  temperature = seq(from = 10, to = 18, by = 1),\n  growth1 = runif(length(temperature), min = -0.7, max = -0.63)*temperature + runif(length(temperature), min = 15, max = 17),\n  growth2 = runif(length(temperature), min = -0.7, max = -0.63)*temperature + runif(length(temperature), min = 15, max = 17),\n  growth3 = runif(length(temperature), min = -0.7, max = -0.63)*temperature + runif(length(temperature), min = 15, max = 17)\n) |> \n  pivot_longer(cols = growth1:growth3,\n               names_to = \"rep\",\n               values_to = \"growth\") |> \n  mutate(growth = round(growth, digits = 1)) |> \n  select(temperature, growth) |> \n  rename(x = temperature,\n         y = growth)\n\n# look at your data:\nhead(abalone, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 Ã— 2\n       x     y\n   <dbl> <dbl>\n 1    10   9.1\n 2    10   9.6\n 3    10   9.7\n 4    11   9  \n 5    11   8.8\n 6    11   8.8\n 7    12   7.5\n 8    12   9.1\n 9    12   8.5\n10    13   6.3\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(data = abalone,\n       aes(x = x,\n           y = y)) +\n  geom_point() \n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/abalone-growth-data-1.png){width=672}\n:::\n:::\n\n\nSeems like there is a linear relationship between temperature and abalone growth. As temperature increases, abalone growth decreases.\n\n### b. fitting a model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nabalone_model <- lm(\n  y ~ x,\n  data = abalone\n)\n\n# just checking DHARMa residuals just in case\nDHARMa::simulateResiduals(abalone_model, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/abalone-model-and-checks-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.328 0.604 0.656 0.62 0.548 0.472 0.228 0.976 0.716 0.052 0.496 0.528 0.128 0.132 0.92 0.352 0.684 0.152 0.98 0.764 ...\n```\n\n\n:::\n\n```{.r .cell-code}\n# base R residuals\npar(mfrow = c(2, 2))\nplot(abalone_model)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/abalone-model-and-checks-2.png){width=672}\n:::\n:::\n\n\n### c. looking at model coefficients\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(abalone_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x, data = abalone)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.15370 -0.50093  0.06019  0.34491  1.24630 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 16.40926    0.69633   23.57  < 2e-16 ***\nx           -0.69722    0.04891  -14.25 1.65e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6562 on 25 degrees of freedom\nMultiple R-squared:  0.8904,\tAdjusted R-squared:  0.8861 \nF-statistic: 203.2 on 1 and 25 DF,  p-value: 1.65e-13\n```\n\n\n:::\n\n```{.r .cell-code}\n# common way of representing model summaries\n# from flextable package\nflextable::as_flextable(abalone_model)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-34698920{}.cl-345a2458{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-345a246c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-34679dae{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-34679daf{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3467ab96{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467ab97{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467aba0{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467aba1{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abaa{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abab{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abac{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abb4{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abb5{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abb6{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abb7{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abbe{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abbf{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abc8{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abc9{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abd2{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abd3{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abdc{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abdd{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abde{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abe6{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abe7{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abe8{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abf0{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abf1{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abf2{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abfa{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abfb{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467abfc{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3467ac04{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-34698920'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-3467ab96\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\"></span></p></th><th class=\"cl-3467ab97\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">Estimate</span></p></th><th class=\"cl-3467aba0\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">Standard Error</span></p></th><th class=\"cl-3467aba1\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">t value</span></p></th><th class=\"cl-3467abaa\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">Pr(&gt;|t|)</span></p></th><th class=\"cl-3467abab\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\"></span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-3467abac\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\">(Intercept)</span></p></td><td class=\"cl-3467abb4\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">16.409</span></p></td><td class=\"cl-3467abb5\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">0.696</span></p></td><td class=\"cl-3467abb6\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">23.565</span></p></td><td class=\"cl-3467abb7\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">0.0000</span></p></td><td class=\"cl-3467abbe\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\">***</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-3467abbf\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\">x</span></p></td><td class=\"cl-3467abc8\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">-0.697</span></p></td><td class=\"cl-3467abc9\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">0.049</span></p></td><td class=\"cl-3467abd2\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">-14.254</span></p></td><td class=\"cl-3467abd3\"><p class=\"cl-34679daf\"><span class=\"cl-345a2458\">0.0000</span></p></td><td class=\"cl-3467abdc\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\">***</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-3467abdd\"><p class=\"cl-34679daf\"><span class=\"cl-345a246c\">Signif. codes: 0 &lt;= '***' &lt; 0.001 &lt; '**' &lt; 0.01 &lt; '*' &lt; 0.05</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-3467abf1\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-3467abf1\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\">Residual standard error: 0.6562 on 25 degrees of freedom</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-3467abf1\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\">Multiple R-squared: 0.8904, Adjusted R-squared: 0.8861</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-3467abf1\"><p class=\"cl-34679dae\"><span class=\"cl-345a2458\">F-statistic: 203.2 on 25 and 1 DF, p-value: 0.0000</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n\n```{.r .cell-code}\n# better table\nflextable::as_flextable(abalone_model) |> \n  set_formatter(values = list(\"p.value\" = function(x){ # special function to represent p < 0.001\n    z <- scales::label_pvalue()(x)\n    z[!is.finite(x)] <- \"\"\n    z\n  }))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-34817850{}.cl-347e824e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-347e8258{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-347facb4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-347facb5{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-347fb998{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb999{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb99a{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9a2{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9a3{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9a4{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9ac{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9ad{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9ae{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9b6{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9b7{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9b8{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9c0{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9c1{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9c2{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9ca{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9cb{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9d4{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9d5{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9d6{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9de{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9df{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9e8{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9e9{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9f2{width:0.981in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9f3{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9f4{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9fc{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9fd{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-347fb9fe{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-34817850'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-347fb998\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\"></span></p></th><th class=\"cl-347fb999\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">Estimate</span></p></th><th class=\"cl-347fb99a\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">Standard Error</span></p></th><th class=\"cl-347fb9a2\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">t value</span></p></th><th class=\"cl-347fb9a3\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">Pr(&gt;|t|)</span></p></th><th class=\"cl-347fb9a4\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\"></span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-347fb9ac\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\">(Intercept)</span></p></td><td class=\"cl-347fb9ad\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">16.409</span></p></td><td class=\"cl-347fb9ae\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">0.696</span></p></td><td class=\"cl-347fb9b6\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">23.565</span></p></td><td class=\"cl-347fb9b7\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">&lt;0.001</span></p></td><td class=\"cl-347fb9b8\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\">***</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-347fb9c0\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\">x</span></p></td><td class=\"cl-347fb9c1\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">-0.697</span></p></td><td class=\"cl-347fb9c2\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">0.049</span></p></td><td class=\"cl-347fb9ca\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">-14.254</span></p></td><td class=\"cl-347fb9cb\"><p class=\"cl-347facb5\"><span class=\"cl-347e824e\">&lt;0.001</span></p></td><td class=\"cl-347fb9d4\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\">***</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-347fb9d5\"><p class=\"cl-347facb5\"><span class=\"cl-347e8258\">Signif. codes: 0 &lt;= '***' &lt; 0.001 &lt; '**' &lt; 0.01 &lt; '*' &lt; 0.05</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-347fb9f2\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-347fb9f2\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\">Residual standard error: 0.6562 on 25 degrees of freedom</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-347fb9f2\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\">Multiple R-squared: 0.8904, Adjusted R-squared: 0.8861</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-347fb9f2\"><p class=\"cl-347facb4\"><span class=\"cl-347e824e\">F-statistic: 203.2 on 25 and 1 DF, p-value: 0.0000</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n\n```{.r .cell-code}\n# somewhat more customizable way\n# from modelsummary package\nmodelsummary(abalone_model)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_2gyxaqhn45q40otzoh59(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_2gyxaqhn45q40otzoh59\");\n          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_2gyxaqhn45q40otzoh59');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_2gyxaqhn45q40otzoh59(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_2gyxaqhn45q40otzoh59\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: 12, j: 1 },  ], css_id: 'tinytable_css_wtqouisypus0t6rarlma',}, \n          { positions: [ { i: 4, j: 1 },  ], css_id: 'tinytable_css_qxuil3dvvsvr5m6h481w',}, \n          { positions: [ { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 8, j: 1 }, { i: 5, j: 1 }, { i: 6, j: 1 }, { i: 7, j: 1 }, { i: 9, j: 1 }, { i: 10, j: 1 }, { i: 11, j: 1 },  ], css_id: 'tinytable_css_0wi5hnuy1zsfeolo65si',}, \n          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_vuwyjysmg8ds6pausaw9',}, \n          { positions: [ { i: 12, j: 0 },  ], css_id: 'tinytable_css_j24ltgc6o77oii04optt',}, \n          { positions: [ { i: 4, j: 0 },  ], css_id: 'tinytable_css_rn2ssagfp8isb187vl6z',}, \n          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 8, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 }, { i: 11, j: 0 },  ], css_id: 'tinytable_css_wzlzt3czftfozgeussbp',}, \n          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_sux2c8ud147akbj29vhu',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_2gyxaqhn45q40otzoh59(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_wtqouisypus0t6rarlma, .table th.tinytable_css_wtqouisypus0t6rarlma { text-align: center; border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_qxuil3dvvsvr5m6h481w, .table th.tinytable_css_qxuil3dvvsvr5m6h481w { text-align: center; border-bottom: solid black 0.05em; }\n      .table td.tinytable_css_0wi5hnuy1zsfeolo65si, .table th.tinytable_css_0wi5hnuy1zsfeolo65si { text-align: center; }\n      .table td.tinytable_css_vuwyjysmg8ds6pausaw9, .table th.tinytable_css_vuwyjysmg8ds6pausaw9 { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n      .table td.tinytable_css_j24ltgc6o77oii04optt, .table th.tinytable_css_j24ltgc6o77oii04optt { text-align: left; border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_rn2ssagfp8isb187vl6z, .table th.tinytable_css_rn2ssagfp8isb187vl6z { text-align: left; border-bottom: solid black 0.05em; }\n      .table td.tinytable_css_wzlzt3czftfozgeussbp, .table th.tinytable_css_wzlzt3czftfozgeussbp { text-align: left; }\n      .table td.tinytable_css_sux2c8ud147akbj29vhu, .table th.tinytable_css_sux2c8ud147akbj29vhu { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_2gyxaqhn45q40otzoh59\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">(1)</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>16.409</td>\n                </tr>\n                <tr>\n                  <td></td>\n                  <td>(0.696)</td>\n                </tr>\n                <tr>\n                  <td>x</td>\n                  <td>-0.697</td>\n                </tr>\n                <tr>\n                  <td></td>\n                  <td>(0.049)</td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.</td>\n                  <td>27</td>\n                </tr>\n                <tr>\n                  <td>R2</td>\n                  <td>0.890</td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.</td>\n                  <td>0.886</td>\n                </tr>\n                <tr>\n                  <td>AIC</td>\n                  <td>57.8</td>\n                </tr>\n                <tr>\n                  <td>BIC</td>\n                  <td>61.7</td>\n                </tr>\n                <tr>\n                  <td>Log.Lik.</td>\n                  <td>-25.899</td>\n                </tr>\n                <tr>\n                  <td>F</td>\n                  <td>203.189</td>\n                </tr>\n                <tr>\n                  <td>RMSE</td>\n                  <td>0.63</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n\n```{.r .cell-code}\n# better table\nmodelsummary(list(\"Abalone model\" = abalone_model), # naming the model\n             fmt = 2, # rounding digits to 2 decimal places\n             estimate = \"{estimate} [{conf.low}, {conf.high}] ({p.value})\", # customizing appearance\n             statistic = NULL, # not displaying standard error\n             gof_omit = 'DF|AIC|BIC|Log.Lik.|RMSE') # taking out some extraneous info\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_09x11sc6yyp7ngnfewzt(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_09x11sc6yyp7ngnfewzt\");\n          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_09x11sc6yyp7ngnfewzt');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_09x11sc6yyp7ngnfewzt(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_09x11sc6yyp7ngnfewzt\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: 6, j: 1 },  ], css_id: 'tinytable_css_suqbm3uelgpklfsutwt2',}, \n          { positions: [ { i: 2, j: 1 },  ], css_id: 'tinytable_css_g1avew64h7xt4ebboy1x',}, \n          { positions: [ { i: 1, j: 1 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 },  ], css_id: 'tinytable_css_cwiznfq53kd6995djsn2',}, \n          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_zi1bri1p710s7qymd1qc',}, \n          { positions: [ { i: 6, j: 0 },  ], css_id: 'tinytable_css_xluq7udcl5n8d0j56wdx',}, \n          { positions: [ { i: 2, j: 0 },  ], css_id: 'tinytable_css_b3u297joir6tds8g8289',}, \n          { positions: [ { i: 1, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 },  ], css_id: 'tinytable_css_h3i93m9ymqhes0nz9sec',}, \n          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_z188k8qlkl0rhgvxirpk',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_09x11sc6yyp7ngnfewzt(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_suqbm3uelgpklfsutwt2, .table th.tinytable_css_suqbm3uelgpklfsutwt2 { text-align: center; border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_g1avew64h7xt4ebboy1x, .table th.tinytable_css_g1avew64h7xt4ebboy1x { text-align: center; border-bottom: solid black 0.05em; }\n      .table td.tinytable_css_cwiznfq53kd6995djsn2, .table th.tinytable_css_cwiznfq53kd6995djsn2 { text-align: center; }\n      .table td.tinytable_css_zi1bri1p710s7qymd1qc, .table th.tinytable_css_zi1bri1p710s7qymd1qc { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n      .table td.tinytable_css_xluq7udcl5n8d0j56wdx, .table th.tinytable_css_xluq7udcl5n8d0j56wdx { text-align: left; border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_b3u297joir6tds8g8289, .table th.tinytable_css_b3u297joir6tds8g8289 { text-align: left; border-bottom: solid black 0.05em; }\n      .table td.tinytable_css_h3i93m9ymqhes0nz9sec, .table th.tinytable_css_h3i93m9ymqhes0nz9sec { text-align: left; }\n      .table td.tinytable_css_z188k8qlkl0rhgvxirpk, .table th.tinytable_css_z188k8qlkl0rhgvxirpk { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_09x11sc6yyp7ngnfewzt\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">Abalone model</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>16.41 [14.98, 17.84] (<0.01)</td>\n                </tr>\n                <tr>\n                  <td>x</td>\n                  <td>-0.70 [-0.80, -0.60] (<0.01)</td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.</td>\n                  <td>27</td>\n                </tr>\n                <tr>\n                  <td>R2</td>\n                  <td>0.890</td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.</td>\n                  <td>0.886</td>\n                </tr>\n                <tr>\n                  <td>F</td>\n                  <td>203.189</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n\n```{.r .cell-code}\n# using gtsummary package\ntbl_regression(abalone_model,\n               intercept = TRUE)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fsyroqvpno\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fsyroqvpno table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fsyroqvpno thead, #fsyroqvpno tbody, #fsyroqvpno tfoot, #fsyroqvpno tr, #fsyroqvpno td, #fsyroqvpno th {\n  border-style: none;\n}\n\n#fsyroqvpno p {\n  margin: 0;\n  padding: 0;\n}\n\n#fsyroqvpno .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fsyroqvpno .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fsyroqvpno .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fsyroqvpno .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fsyroqvpno .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fsyroqvpno .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fsyroqvpno .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fsyroqvpno .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fsyroqvpno .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fsyroqvpno .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fsyroqvpno .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fsyroqvpno .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fsyroqvpno .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fsyroqvpno .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fsyroqvpno .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fsyroqvpno .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fsyroqvpno .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fsyroqvpno .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fsyroqvpno .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fsyroqvpno .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fsyroqvpno .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fsyroqvpno .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fsyroqvpno .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fsyroqvpno .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fsyroqvpno .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fsyroqvpno .gt_left {\n  text-align: left;\n}\n\n#fsyroqvpno .gt_center {\n  text-align: center;\n}\n\n#fsyroqvpno .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fsyroqvpno .gt_font_normal {\n  font-weight: normal;\n}\n\n#fsyroqvpno .gt_font_bold {\n  font-weight: bold;\n}\n\n#fsyroqvpno .gt_font_italic {\n  font-style: italic;\n}\n\n#fsyroqvpno .gt_super {\n  font-size: 65%;\n}\n\n#fsyroqvpno .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fsyroqvpno .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fsyroqvpno .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fsyroqvpno .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fsyroqvpno .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fsyroqvpno .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fsyroqvpno .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#fsyroqvpno .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#fsyroqvpno div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"PHN0cm9uZz5DaGFyYWN0ZXJpc3RpYzwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"PHN0cm9uZz5CZXRhPC9zdHJvbmc+\"><span class='gt_from_md'><strong>Beta</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"PHN0cm9uZz45NSUgQ0k8L3N0cm9uZz4=\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"PHN0cm9uZz5wLXZhbHVlPC9zdHJvbmc+\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">16</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">15, 18</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">x</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-0.70</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">-0.80, -0.60</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uOiBDSSA9IENvbmZpZGVuY2UgSW50ZXJ2YWw=\"><span class='gt_from_md'>Abbreviation: CI = Confidence Interval</span></span></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\n# more customizing\ntbl_regression(abalone_model, # model object\n               intercept = TRUE) |> # show the intercept\n  as_flex_table() # turn it into a flextable (easier to save)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-3543d990{}.cl-3540c8f4{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-3540c8f5{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-35425d18{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-35425d36{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-35425d40{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-35425d41{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-35425d42{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-35426826{width:1.304in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426827{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426828{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426829{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426830{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426831{width:0.633in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426832{width:1.067in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426833{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3542684e{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3542684f{width:0.633in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426850{width:1.067in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426858{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-35426859{width:1.304in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3542685a{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3542685b{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3542685c{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-3543d990'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-35426826\"><p class=\"cl-35425d18\"><span class=\"cl-3540c8f4\">Characteristic</span></p></th><th class=\"cl-35426827\"><p class=\"cl-35425d36\"><span class=\"cl-3540c8f4\">Beta</span></p></th><th class=\"cl-35426828\"><p class=\"cl-35425d36\"><span class=\"cl-3540c8f4\">95% CI</span></p></th><th class=\"cl-35426829\"><p class=\"cl-35425d36\"><span class=\"cl-3540c8f4\">p-value</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-35426830\"><p class=\"cl-35425d40\"><span class=\"cl-3540c8f5\">(Intercept)</span></p></td><td class=\"cl-35426831\"><p class=\"cl-35425d41\"><span class=\"cl-3540c8f5\">16</span></p></td><td class=\"cl-35426832\"><p class=\"cl-35425d41\"><span class=\"cl-3540c8f5\">15, 18</span></p></td><td class=\"cl-35426833\"><p class=\"cl-35425d41\"><span class=\"cl-3540c8f5\">&lt;0.001</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-3542684e\"><p class=\"cl-35425d40\"><span class=\"cl-3540c8f5\">x</span></p></td><td class=\"cl-3542684f\"><p class=\"cl-35425d41\"><span class=\"cl-3540c8f5\">-0.70</span></p></td><td class=\"cl-35426850\"><p class=\"cl-35425d41\"><span class=\"cl-3540c8f5\">-0.80, -0.60</span></p></td><td class=\"cl-35426858\"><p class=\"cl-35425d41\"><span class=\"cl-3540c8f5\">&lt;0.001</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"4\"class=\"cl-35426859\"><p class=\"cl-35425d42\"><span class=\"cl-3540c8f5\">Abbreviation: CI = Confidence Interval</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(abalone_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: y\n          Df Sum Sq Mean Sq F value   Pr(>F)    \nx          1 87.501  87.501  203.19 1.65e-13 ***\nResiduals 25 10.766   0.431                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n### d. visualizing the model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_preds <- ggpredict(\n  abalone_model,\n  terms = \"x\"\n)\n\n# look at the output:\nmodel_preds\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Predicted values of y\n\n x | Predicted |     95% CI\n---------------------------\n10 |      9.44 | 8.96, 9.92\n11 |      8.74 | 8.34, 9.14\n12 |      8.04 | 7.71, 8.37\n13 |      7.35 | 7.07, 7.62\n14 |      6.65 | 6.39, 6.91\n15 |      5.95 | 5.67, 6.23\n16 |      5.25 | 4.92, 5.58\n18 |      3.86 | 3.38, 4.34\n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(abalone_model, \n          terms = \"x[18]\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Predicted values of y\n\n x | Predicted |     95% CI\n---------------------------\n18 |      3.86 | 3.38, 4.34\n```\n\n\n:::\n\n```{.r .cell-code}\n# plotting without 95% CI\nggplot(abalone, # using the actual data\n       aes(x = x, # x-axis\n           y = y)) + # y-axis\n  geom_point(color = \"cornflowerblue\", # each point is an individual abalone\n             size = 3) +\n  \n  # model prediction: actual model line\n  geom_line(data = model_preds, # model prediction table\n            aes(x = x, # x-axis\n                y = predicted), # y-axis\n            linewidth = 1)  # line width\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/abalone-plot-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# plotting\nggplot(abalone, # using the actual data\n       aes(x = x, # x-axis\n           y = y)) + # y-axis\n  \n  # plot the data first\n  # each point is an individual abalone\n  geom_point(color = \"cornflowerblue\",\n             size = 3) + \n  \n  # model prediction: 95% CI\n  geom_ribbon(data = model_preds, # model prediction table\n              aes(x = x, # x-axis\n                  y = predicted, # y-axis\n                  ymin = conf.low, # lower bound of 95% CI\n                  ymax = conf.high), # upper bound of 95% CI\n              alpha = 0.2) + # transparency) \n  \n  # model prediction: actual model line\n  geom_line(data = model_preds, # model prediction table\n            aes(x = x, # x-axis\n                y = predicted), # y-axis\n            linewidth = 1) # line width\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/abalone-plot-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# compare with:\nggplot(abalone,\n       aes(x = x,\n           y = y)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/abalone-plot-3.png){width=672}\n:::\n:::\n\n\n### e. outliers\n\n\n::: {.cell}\n\n```{.r .cell-code}\nabalone |> \n  mutate(outlier = ifelse(row_number() %in% c(19, 21, 27), \"yes\", \"no\")) |> \n  ggplot(aes(x = x,\n             y = y)) +\n  geom_point(aes(color = outlier), \n             size = 3) + \n  geom_line(data = model_preds,\n            aes(x = x,\n                y = predicted),\n            linewidth = 1) +\n  scale_color_manual(values = c(\"yes\" = \"red\", \"no\" = \"cornflowerblue\")) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/outlier-checks-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# new abalone data frame\nabalone2 <- abalone |> \n  slice(-c(19, 21, 27))\n\nabalone_model2 <- lm(y ~ x,\n                    data = abalone2)\n\nsummary(abalone_model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x, data = abalone2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.01641 -0.44359  0.08359  0.34163  1.05272 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 16.81772    0.60270   27.90  < 2e-16 ***\nx           -0.73087    0.04336  -16.85 4.61e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.537 on 22 degrees of freedom\nMultiple R-squared:  0.9281,\tAdjusted R-squared:  0.9249 \nF-statistic: 284.1 on 1 and 22 DF,  p-value: 4.606e-14\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_preds2 <- ggpredict(abalone_model2, terms = \"x\")\n\nggplot(data = abalone2,\n       aes(x = x,\n           y = y)) +\n  geom_point(color = \"cornflowerblue\",\n             size = 3) +\n  geom_line(data = model_preds2,\n            aes(x = x,\n                y = predicted), \n            linewidth = 1)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/outlier-checks-2.png){width=672}\n:::\n:::\n\n\n### f. actual data\n\nData from: Hamilton et al. 2022. _Aquaculture_. \"Integrated multi-trophic aquaculture mitigates the effects of ocean acidification: Seaweeds raise system pH and improve growth of juvenile abalone.\"  \n\nThank you to Scott for being willing to share this data!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nabalone <- read_xlsx(here(\"data\", \"Abalone IMTA_growth and pH.xlsx\")) |> \n  clean_names()\n\n# creating clean dataset\nabalone_clean <- abalone |> # start with abalone object\n  # select columns of interest\n  select(mean_p_h, change_in_area_mm2_d_1_25, recirculation_treatment) |> \n  # rename columns\n  rename(mean_ph = mean_p_h, \n         change_in_area = change_in_area_mm2_d_1_25,\n         recirculation = recirculation_treatment) |> \n  # recod recirculation\n  mutate(recirculation = case_when(\n    recirculation == 0 ~ \"0% recirculation\",\n    recirculation == 0.3 ~ \"30% recirculation\",\n    recirculation == 0.65 ~ \"65% recirculation\"\n  ))\n\n# base layer: ggplot\nggplot(data = abalone_clean,\n       aes(x = mean_ph,\n           y = change_in_area)) +\n  # first layer: points representing abalones\n  geom_point(size = 4,\n             stroke = 1,\n             fill = \"firebrick3\",\n             shape = 21)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/hamilton-et-al-data-1.png){width=672}\n:::\n\n```{.r .cell-code}\nabalone_model <- lm(\n  change_in_area ~ mean_ph, # formula: change in area as a function of pH\n  data = abalone_clean      # data frame: abalone_clean\n)\n\nDHARMa::simulateResiduals(abalone_model) |> \n  plot()\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/hamilton-et-al-data-2.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))   # creating a 2x2 grid\nplot(abalone_model)    # plot diagnostic plots\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/hamilton-et-al-data-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# more information about the model\nsummary(abalone_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = change_in_area ~ mean_ph, data = abalone_clean)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.42714 -0.29282  0.08769  0.21258  0.43965 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept) -18.5010     6.1601  -3.003  0.01488 * \nmean_ph       2.9827     0.7596   3.926  0.00348 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3063 on 9 degrees of freedom\n  (1 observation deleted due to missingness)\nMultiple R-squared:  0.6314,\tAdjusted R-squared:  0.5905 \nF-statistic: 15.42 on 1 and 9 DF,  p-value: 0.003477\n```\n\n\n:::\n\n```{.r .cell-code}\n# creating a new object called abalone_preds\nabalone_preds <- ggpredict(\n  abalone_model,      # model object\n  terms = \"mean_ph\"   # predictor (in quotation marks)\n)\n\n# display the predictions\nabalone_preds\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Predicted values of change_in_area\n\nmean_ph | Predicted |     95% CI\n--------------------------------\n   7.94 |      5.19 | 4.83, 5.54\n   7.95 |      5.21 | 4.86, 5.55\n   8.06 |      5.53 | 5.30, 5.76\n   8.10 |      5.67 | 5.46, 5.88\n   8.10 |      5.67 | 5.46, 5.88\n   8.14 |      5.77 | 5.55, 5.98\n   8.15 |      5.81 | 5.59, 6.04\n   8.33 |      6.36 | 5.92, 6.80\n```\n\n\n:::\n\n```{.r .cell-code}\n# look at the column names\ncolnames(abalone_preds)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"x\"         \"predicted\" \"std.error\" \"conf.low\"  \"conf.high\" \"group\"    \n```\n\n\n:::\n\n```{.r .cell-code}\n# look at the \"class\" (i.e. \"type\") of object\nclass(abalone_preds)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"ggeffects\"  \"data.frame\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# base layer: ggplot\n# using clean data frame\nggplot(data = abalone_clean,\n       aes(x = mean_ph,\n           y = change_in_area)) +\n  # first layer: points representing abalones\n  geom_point(size = 4,\n             stroke = 1,\n             fill = \"firebrick3\",\n             shape = 21) +\n  # second layer: ribbon representing confidence interval\n  # using predictions data frame\n  geom_ribbon(data = abalone_preds,\n              aes(x = x,\n                  y = predicted,\n                  ymin = conf.low,\n                  ymax = conf.high),\n              alpha = 0.1) +\n  # third layer: line representing model predictions\n  # using predictions data frame\n  geom_line(data = abalone_preds,\n            aes(x = x,\n                y = predicted),\n            linewidth = 1) +\n  # axis labels\n  labs(x = \"Mean pH\", \n       y = expression(\"Change in shell area (\"*mm^{2}~d^-1*\")\"))\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/hamilton-et-al-data-4.png){width=672}\n:::\n:::\n\n\n## 4. Exponential growth example\n\nTo compare with abalone example\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_ex <- tibble(\n  x = seq(from = 10, to = 18, length = 27),\n  y = c(15, 15, 15, \n        15, 14.3, 14.2, \n        14.1, 14, 13.9,\n        13.9, 13.8, 13.7,\n        13.2, 13.1, 13,\n        12.5, 11.1, 10,\n        9.9, 7, 5,\n        3, 1.7, 1,\n        0.5, 0.3, 0.1)\n) \n\nlm_ex <- lm(y ~ x, data = df_ex)\n\nsummary(lm_ex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x, data = df_ex)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.2540 -2.0605 -0.4009  2.3533  3.6288 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  38.5833     2.6772   14.41 1.29e-13 ***\nx            -2.0329     0.1885  -10.79 6.82e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.347 on 25 degrees of freedom\nMultiple R-squared:  0.8231,\tAdjusted R-squared:  0.816 \nF-statistic: 116.3 on 1 and 25 DF,  p-value: 6.823e-11\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(data = df_ex,\n       aes(x = x,\n           y = y)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/exp-data-and-model-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlm_pred <- ggpredict(lm_ex, terms = ~x)\n\nex_plot_noline <- ggplot(df_ex, aes(x= x, y = y)) +\n  geom_point(size = 3, color = \"orange\") +\n  theme_classic() +\n  theme(text = element_text(size = 14))\n\nex_plot_noline\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/exp-data-and-model-2.png){width=672}\n:::\n\n```{.r .cell-code}\nex_plot <- ggplot(df_ex, aes(x= x, y = y)) +\n  geom_point(size = 3, color = \"orange\") +\n  geom_line(data = lm_pred, aes(x = x, y = predicted), linewidth = 1) +\n  theme(text = element_text(size = 14)) \n\nex_plot\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/exp-data-and-model-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(lm_ex)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/exponential-diagnostics-1.png){width=672}\n:::\n\n```{.r .cell-code}\nDHARMa::simulateResiduals(lm_ex) |> plot()\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/exponential-diagnostics-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# if using quarto, don't label chunk with a table... so weird\nanova_tbl <- broom::tidy(anova(model1)) |> \n  mutate(across(where(is.numeric), ~ round(.x, digits = 2))) |> \n  mutate(p.value = case_when(\n    p.value < 0.001 ~ \"< 0.001\"\n  )) \n\nflextable(anova_tbl) |> \n  set_header_labels(term = \"Term\", \n                    df = \"Degrees of freedom\", \n                    sumsq = \"Sum of squares\", \n                    meansq = \"Mean squares\", \n                    statistic = \"F-statistic\", \n                    p.value = \"p-value\") |> \n  set_table_properties(layout = \"autofit\", width = 0.8)\n```\n:::\n\n\n\n# 5. Temperature/elevation example\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# data\nsonadora <- read_csv(here::here(\"data\", \"knb-lter-luq.183.877108\", \"Temp_SonadoraGradient_Daily.csv\"))\n\n# cleaning\nsonadora_clean <- sonadora |> \n  janitor::clean_names() |> \n  pivot_longer(cols = plot_250:plot_1000,\n               names_to = \"plot_name\",\n               values_to = \"temp_c\") |> \n  separate_wider_delim(cols = plot_name,\n                       delim = \"_\",\n                       names = c(\"plot\", \"elevation_m\"),\n                       cols_remove = FALSE) |> \n  select(-plot) |> \n  mutate(elevation_m = as.numeric(elevation_m))\n\n# summarizing\nsonadora_sum <- sonadora_clean |> \n  group_by(plot_name, elevation_m) |> \n  reframe(mean_temp_c = mean(temp_c, na.rm = TRUE)) |> \n  arrange(elevation_m)\n\n# model\nmodel <- lm(mean_temp_c ~ elevation_m, data = sonadora_sum)\n\n# visualization\nggplot(data = sonadora_sum, \n       aes(x = elevation_m,\n           y = mean_temp_c)) +\n  geom_point(size = 3) +\n  labs(x = \"Elevation (m)\",\n       y = \"Temperature (Â°C)\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/sonadora-temperature-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# diagnostics from DHARMa\nDHARMa::simulateResiduals(model, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/sonadora-temperature-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.484 0.476 0.264 0.764 0.472 0.36 0.336 0.396 0.564 0.44 0.548 0.792 0.856 0.948 0.604 0\n```\n\n\n:::\n\n```{.r .cell-code}\n# summary\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mean_temp_c ~ elevation_m, data = sonadora_sum)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.67288 -0.07577  0.00022  0.09393  0.37042 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 24.7807991  0.1719438  144.12  < 2e-16 ***\nelevation_m -0.0055446  0.0002581  -21.48 4.08e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.238 on 14 degrees of freedom\nMultiple R-squared:  0.9706,\tAdjusted R-squared:  0.9684 \nF-statistic: 461.4 on 1 and 14 DF,  p-value: 4.075e-12\n```\n\n\n:::\n\n```{.r .cell-code}\ntidy(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 Ã— 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept) 24.8      0.172        144.  1.32e-23\n2 elevation_m -0.00554  0.000258     -21.5 4.08e-12\n```\n\n\n:::\n\n```{.r .cell-code}\n# model predictions\nggpredict(model) |> plot(show_data = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/sonadora-temperature-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# diagnostics\npar(mfrow = c(2, 2))\nplot(model)\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/sonadora-diagnostics-1.png){width=1152}\n:::\n:::\n\n\n# 6. correlation\n\n### a. abalone correlation\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(abalone_clean$mean_ph, abalone_clean$change_in_area,\n         method = \"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  abalone_clean$mean_ph and abalone_clean$change_in_area\nt = 3.9265, df = 9, p-value = 0.003477\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.3721101 0.9443471\nsample estimates:\n      cor \n0.7946121 \n```\n\n\n:::\n:::\n\n\n### b. correlation but different slopes\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorr_df <- tibble(\n  x = seq(from = 1, to = 10, by = 0.5),\n  y1 = 0.25*x,\n  y2 = 1*x\n) \n\ncorr_0.25 <- ggplot(data = corr_df,\n                    aes(x = x,\n                        y = y1)) +\n  geom_point(size = 3) +\n  scale_y_continuous(limits = c(0, 10))\n\ncorr_1 <- ggplot(data = corr_df,\n                 aes(x = x,\n                     y = y2)) +\n  geom_point(size = 3) +\n  scale_y_continuous(limits = c(0, 10))\n\ncorr_0.25 + corr_1\n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/correlation-1.png){width=1152}\n:::\n:::\n\n\n\n### c. no correlation but clear relationship\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_lm <- seq(from = 1, to = 30, length.out = 50)\n# y = a( x â€“ h) 2 + k\ndf_para <- cbind(\n  x = x_lm,\n  y = 0.1*(x_lm - 15)^2 + 12\n) |> \n  as_tibble()\n\nggplot(data = df_para, \n       aes(x = x, \n           y = y)) +\n  geom_point(size = 3) \n```\n\n::: {.cell-output-display}\n![](lecture_week-07_files/figure-html/parabola-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncor.test(df_para$x, df_para$y, method = \"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  df_para$x and df_para$y\nt = 0.90749, df = 48, p-value = 0.3687\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.1540408  0.3939806\nsample estimates:\n      cor \n0.1298756 \n```\n\n\n:::\n:::\n\n\n\n# exponential growth example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_ex <- seq(from = 5, to = 9, length = 30)\n\ny_ex <- exp(x_ex)\n\ndf_ex <- cbind(\n  x = x_ex,\n  y = -exp(x_ex)\n) |> \n  as_tibble()\n\nlm_ex <- lm(y ~ x, data = df_ex)\n\nlm_ex\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x, data = df_ex)\n\nCoefficients:\n(Intercept)            x  \n       9431        -1642  \n```\n\n\n:::\n:::\n\n\n## model summary\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm_ex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x, data = df_ex)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2756.1  -660.5   226.3   843.2  1081.0 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   9431.3     1111.3   8.486 3.16e-09 ***\nx            -1642.0      156.5 -10.492 3.30e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1023 on 28 degrees of freedom\nMultiple R-squared:  0.7972,\tAdjusted R-squared:   0.79 \nF-statistic: 110.1 on 1 and 28 DF,  p-value: 3.298e-11\n```\n\n\n:::\n:::\n\n\n## model plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_pred <- ggpredict(lm_ex, terms = ~x)\n\nex_plot_noline <- ggplot(df_ex, aes(x= x, y = y)) +\n  geom_point(shape = 17, size = 3, color = \"orange\") +\n  theme_classic() +\n  theme(text = element_text(size = 14))\n\nex_plot <- ggplot(df_ex, aes(x= x, y = y)) +\n  geom_point(shape = 17, size = 3, color = \"orange\") +\n  geom_line(data = lm_pred, aes(x = x, y = predicted), linewidth = 1) +\n  theme_classic() +\n  theme(text = element_text(size = 14))\n```\n:::\n\n\n# diagnostic plots\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 4))\nplot(model1, which = c(1), col = \"cornflowerblue\", pch = 19)\nplot(lm_ex, which = c(1), col = \"orange\", pch = 17)\nplot(model1, which = c(2), col = \"cornflowerblue\", pch = 19)\nplot(lm_ex, which = c(2), col = \"orange\", pch = 17)\nplot(model1, which = c(3), col = \"cornflowerblue\", pch = 19)\nplot(lm_ex, which = c(3), col = \"orange\", pch = 17)\nplot(model1, which = c(5), col = \"cornflowerblue\", pch = 19)\nplot(lm_ex, which = c(5), col = \"orange\", pch = 17)\ndev.off()\n```\n:::\n",
    "supporting": [
      "lecture_week-07_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}