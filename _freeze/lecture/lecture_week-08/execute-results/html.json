{
  "hash": "e155a3cde36f73136dfa6c5bde4e0d7d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 8 figures - Lectures 14 and 15\"\neditor: source\nfreeze: auto\nexecute:\n  message: false\n  warning: false\nformat:\n  html: \n    code-fold: true\nauthor:\n  - name: An Bui\n    url: https://an-bui.com/\n    affiliation: UC Santa Barbara, Ecology, Evolution, and Marine Biology\n    affiliation-url: https://www.eemb.ucsb.edu/\npublished-title: \"Lecture date\"\ndate: 2024-05-20\ndate-modified: last-modified\ncategories: [multiple linear regression, AIC]\ncitation:\n  url: https://spring-2024.envs-193ds.com/lecture/lecture_week-08.html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# cleaning\nlibrary(tidyverse)\n\n# visualization\ntheme_set(theme_classic() +\n            theme(panel.grid = element_blank(),\n                  axis.text = element_text(size = 18),\n                  axis.title = element_text(size = 18),\n                  text = element_text(family = \"Lato\")))\nlibrary(patchwork)\nlibrary(ggeffects)\nlibrary(flextable)\nlibrary(GGally)\n\n# data\nlibrary(palmerpenguins)\n\n# analysis\nlibrary(car)\nlibrary(performance)\nlibrary(broom)\nlibrary(DHARMa)\nlibrary(MuMIn)\n```\n:::\n\n\n# multiple linear regression equation\n\n$$\n\\begin{align}\ny &= \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + ... \\beta_kx_k + \\epsilon\n\\end{align}\n$$\n\n# formulas\n\n## sum of squares for linear regression\n\n### regression (or model)\n\n$$\nSS_{reg} = \\sum_{i = 1}^{n}(\\hat{y} - \\bar{y})^2\n$$\n\n### error\n\n$$\nSS_{err} = \\sum_{i = 1}^{n}(y_i - \\hat{y})^2\n$$\n\n### total \n\n$$\nSS_{tot} = \\sum_{i = 1}^n(y_i - \\bar{y})\n$$\n\n## mean square\n\n### regression\n\n$$\nMS_{reg} = \\frac{SS_{reg}}{1}\n$$\n\n### error\n\n$$\nMS_{err} = \\frac{SS_{err}}{n - 2}\n$$\n\n## F-statistic\n\n$$\nF = \\frac{MS_{reg}}{MS_{err}}\n$$\n\n# soil example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\n# sample size\nn <- 64\n\nsoil_df <- tibble(\n  # compaction\n  force_mpa = round(rnorm(n = n, mean = 0.7, sd = 0.03), 3),\n  # root length\n  root_mm = round(rnorm(n = n, mean = -1, sd = 0.02)*force_mpa, 3) + 5\n) \n\nggplot(data = soil_df,\n       aes(x = force_mpa,\n           y = root_mm)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsoil_lm <- lm(root_mm ~ force_mpa,\n              data = soil_df)\n\npar(mfrow = c(2, 2))\nplot(soil_lm)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(soil_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = root_mm ~ force_mpa, data = soil_df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.033749 -0.009088  0.000251  0.008962  0.028832 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   4.9569     0.0357   138.9   <2e-16 ***\nforce_mpa    -0.9400     0.0511   -18.4   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.01338 on 62 degrees of freedom\nMultiple R-squared:  0.8451,\tAdjusted R-squared:  0.8427 \nF-statistic: 338.4 on 1 and 62 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(soil_df$root_mm, soil_df$force_mpa)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  soil_df$root_mm and soil_df$force_mpa\nt = -18.395, df = 62, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9503672 -0.8701422\nsample estimates:\n       cor \n-0.9193192 \n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(soil_lm,\n          terms = \"force_mpa\") %>% \n  plot(show_data = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\nflextable::as_flextable(soil_lm) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-13387b6a{}.cl-132ae734{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-132ae73e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-13363a6c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-13363a76{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-13364386{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-13364387{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-13364388{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-13364390{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-13364391{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-13364392{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-13364393{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1336439a{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1336439b{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1336439c{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643a4{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643a5{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643a6{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643a7{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643ae{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643af{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643b0{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643b1{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643b8{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643b9{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643ba{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643bb{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643c2{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643c3{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643c4{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643c5{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643cc{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643cd{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643ce{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-133643d6{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-13387b6a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-13364386\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\"></span></p></th><th class=\"cl-13364387\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">Estimate</span></p></th><th class=\"cl-13364388\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">Standard Error</span></p></th><th class=\"cl-13364390\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">t value</span></p></th><th class=\"cl-13364391\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">Pr(&gt;|t|)</span></p></th><th class=\"cl-13364392\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\"></span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-13364393\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\">(Intercept)</span></p></td><td class=\"cl-1336439a\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">4.957</span></p></td><td class=\"cl-1336439b\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">0.036</span></p></td><td class=\"cl-1336439c\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">138.866</span></p></td><td class=\"cl-133643a4\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">0.0000</span></p></td><td class=\"cl-133643a5\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\">***</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-133643a6\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\">force_mpa</span></p></td><td class=\"cl-133643a7\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">-0.940</span></p></td><td class=\"cl-133643ae\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">0.051</span></p></td><td class=\"cl-133643af\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">-18.395</span></p></td><td class=\"cl-133643b0\"><p class=\"cl-13363a76\"><span class=\"cl-132ae734\">0.0000</span></p></td><td class=\"cl-133643b1\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\">***</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-133643b8\"><p class=\"cl-13363a76\"><span class=\"cl-132ae73e\">Signif. codes: 0 &lt;= '***' &lt; 0.001 &lt; '**' &lt; 0.01 &lt; '*' &lt; 0.05</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-133643c4\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-133643c4\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\">Residual standard error: 0.01338 on 62 degrees of freedom</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-133643c4\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\">Multiple R-squared: 0.8451, Adjusted R-squared: 0.8427</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-133643c4\"><p class=\"cl-13363a6c\"><span class=\"cl-132ae734\">F-statistic: 338.4 on 62 and 1 DF, p-value: 0.0000</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n\n```{.r .cell-code}\nflextable::as_flextable(soil_lm) %>% \n  set_formatter(\n    # special function to represent p < 0.001\n    values = list(\"p.value\" = function(x){ \n      z <- scales::label_pvalue()(x)\n      z[!is.finite(x)] <- \"\"\n      z\n    })\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-134e2244{}.cl-134b3f7a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-134b3f84{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-134ca676{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-134ca680{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-134cad88{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad89{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad8a{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad8b{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad92{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad93{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad94{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad95{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad96{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad97{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad9c{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad9d{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad9e{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cad9f{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cada0{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cada1{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cada2{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cada6{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cada7{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cada8{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cada9{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadaa{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadab{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadac{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadb0{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadb1{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadb2{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadb3{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadb4{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-134cadb5{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-134e2244'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-134cad88\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\"></span></p></th><th class=\"cl-134cad89\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">Estimate</span></p></th><th class=\"cl-134cad8a\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">Standard Error</span></p></th><th class=\"cl-134cad8b\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">t value</span></p></th><th class=\"cl-134cad92\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">Pr(&gt;|t|)</span></p></th><th class=\"cl-134cad93\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\"></span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-134cad94\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\">(Intercept)</span></p></td><td class=\"cl-134cad95\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">4.957</span></p></td><td class=\"cl-134cad96\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">0.036</span></p></td><td class=\"cl-134cad97\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">138.866</span></p></td><td class=\"cl-134cad9c\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">&lt;0.001</span></p></td><td class=\"cl-134cad9d\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\">***</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-134cad9e\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\">force_mpa</span></p></td><td class=\"cl-134cad9f\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">-0.940</span></p></td><td class=\"cl-134cada0\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">0.051</span></p></td><td class=\"cl-134cada1\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">-18.395</span></p></td><td class=\"cl-134cada2\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f7a\">&lt;0.001</span></p></td><td class=\"cl-134cada6\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\">***</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-134cada7\"><p class=\"cl-134ca680\"><span class=\"cl-134b3f84\">Signif. codes: 0 &lt;= '***' &lt; 0.001 &lt; '**' &lt; 0.01 &lt; '*' &lt; 0.05</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-134cadb0\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-134cadb0\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\">Residual standard error: 0.01338 on 62 degrees of freedom</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-134cadb0\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\">Multiple R-squared: 0.8451, Adjusted R-squared: 0.8427</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-134cadb0\"><p class=\"cl-134ca676\"><span class=\"cl-134b3f7a\">F-statistic: 338.4 on 62 and 1 DF, p-value: 0.0000</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n:::\n\n\n\n# plant example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\n# sample size\nn <- 64\nplant_df <- tibble(\n  # predictor variables\n  temperature = round(rnorm(n = n, mean = 28, sd = 1), digits = 1),\n  light = round(rnorm(n = n, mean = 1, sd = 0.2), digits = 1),\n  ph = rnorm(n = n, mean = 7, sd = 0.01),\n  \n  # response: growth in cm/week\n  growth = light*rnorm(n = n, mean = 0.3, sd = 0.1) + temperature/round(rnorm(n = n, mean = 5, sd = 0.1))\n) \n\nggplot(data = plant_df,\n       aes(x = temperature,\n           y = growth)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = plant_df,\n       aes(x = ph,\n           y = light)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = plant_df,\n       aes(x = light,\n           y = growth)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplant_model <- lm(growth ~ light + temperature, \n                  data = plant_df)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsimulateResiduals(plant_model,\n                  plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-diagnostics-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0 0.756 0.792 0.816 0.06 0.132 0.408 0.708 0.988 0.892 0.452 0.876 0.644 0.512 0.984 0.904 0.936 0.56 0.58 0.724 ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(plant_model)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-model-performance-1.png){width=672}\n:::\n\n```{.r .cell-code}\npairs(plant_df, upper.panel = NULL)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-model-performance-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggpairs(plant_df)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-model-performance-3.png){width=672}\n:::\n\n```{.r .cell-code}\ncor(plant_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            temperature       light          ph      growth\ntemperature  1.00000000  0.15540780 -0.06657697  0.89551840\nlight        0.15540780  1.00000000 -0.04769987  0.40397013\nph          -0.06657697 -0.04769987  1.00000000 -0.02466729\ngrowth       0.89551840  0.40397013 -0.02466729  1.00000000\n```\n\n\n:::\n\n```{.r .cell-code}\nvif(plant_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      light temperature \n   1.024749    1.024749 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(plant_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = growth ~ light + temperature, data = plant_df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.227058 -0.071297  0.006266  0.063745  0.197573 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  0.08464    0.29166   0.290    0.773    \nlight        0.34972    0.05934   5.894 1.76e-07 ***\ntemperature  0.19563    0.01056  18.534  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.09109 on 61 degrees of freedom\nMultiple R-squared:  0.8738,\tAdjusted R-squared:  0.8697 \nF-statistic: 211.2 on 2 and 61 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# anova(plant_model)\n```\n:::\n\n\nFor example, temperature F-value:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n2.85039/0.0083\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 343.4205\n```\n\n\n:::\n:::\n\n\n$$\n\\begin{align}\nF &= \\frac{2.85039}{0.00830} \\\\\n&= 343.4205\n\\end{align}\n$$\n\n# dummy variable examples\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  herbivores = sample(x = c(\"absent\", \"present\"), size = 10, replace = TRUE, prob = c(0.5, 0.5))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 1\n   herbivores\n   <chr>     \n 1 absent    \n 2 absent    \n 3 absent    \n 4 present   \n 5 present   \n 6 absent    \n 7 present   \n 8 absent    \n 9 present   \n10 present   \n```\n\n\n:::\n\n```{.r .cell-code}\ntibble(\n  fertilizer = sample(x = c(\"low\", \"medium\", \"high\"), size = 10, replace = TRUE, prob = c(0.3, 0.3, 0.3))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 1\n   fertilizer\n   <chr>     \n 1 high      \n 2 low       \n 3 medium    \n 4 medium    \n 5 high      \n 6 low       \n 7 high      \n 8 low       \n 9 low       \n10 high      \n```\n\n\n:::\n\n```{.r .cell-code}\ndf <- tibble(\n  year = sample(x = c(\"1st\", \"2nd\", \"3rd\", \"4th\", \"5th\"), size = 10, replace = TRUE, prob = c(0.2, 0.2, 0.2, 0.2, 0.2))\n)\n\ndf %>% \n  mutate(year = as_factor(year))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 1\n   year \n   <fct>\n 1 4th  \n 2 2nd  \n 3 1st  \n 4 4th  \n 5 5th  \n 6 1st  \n 7 5th  \n 8 2nd  \n 9 3rd  \n10 2nd  \n```\n\n\n:::\n:::\n\n\n\n# frog example\n\n## generating data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\nfrog_n <- 87\n\ndf <- cbind(\n  # predictor variables\n  # color = sample(x = c(\"blue\", \"green\", \"red\"), size = frog_n, replace = TRUE, prob = c(0.3, 0.3, 0.3)),\n  weight = (round(rnorm(n = frog_n, mean = 3, sd = 0.1), 2))\n  #pattern = sample(x = c(\"striped\", \"spotted\", \"none\"), size = frog_n, replace = TRUE, prob = c(0.3, 0.3, 0.3))\n) %>%\n  as_tibble() %>%\n  mutate(toxicity = round(rnorm(n = frog_n, mean = 1.5, sd = 0.06)*weight, 3)) %>%\n  mutate(color = case_when(\n    between(toxicity, 2.5, 4.4) ~ \"blue\",\n    between(toxicity, 4.4, 4.6) ~ \"green\",\n    between(toxicity, 4.6, 5.5) ~ \"red\"\n  )) %>% \n  mutate(toxicity = case_when(\n    color == \"blue\" ~ round(rnorm(n = frog_n, mean = 2.5, sd = 0.09)*weight, 3),\n    color == \"green\" ~ round(rnorm(n = frog_n, mean = 3, sd = 0.05)*weight, 3),\n    color == \"red\" ~ round(rnorm(n = frog_n, mean = 2.3, sd = 0.05)*weight, 3)\n  )) %>% \n  mutate(color = as_factor(color),\n         color = fct_relevel(color, \"red\", \"blue\", \"green\"))\n\n\n# df <- cbind(\n#   color = sample(x = c(\"blue\", \"green\", \"red\"), size = frog_n, replace = TRUE, prob = c(0.3, 0.3, 0.3))\n# ) %>% \n#   as_tibble() %>% \n#   mutate(weight = (round(rnorm(n = frog_n, mean = 3.5, sd = 0.1), 2))) %>% \n#   mutate(toxicity = case_when(\n#     color == \"blue\" ~ round(rnorm(n = frog_n, mean = 3, sd = 0.4)*weight, 2),\n#     color == \"green\" ~ round(rnorm(n = frog_n, mean = 2, sd = 0.5)*weight, 2),\n#     color == \"red\" ~ round(rnorm(n = frog_n, mean = 1, sd = 0.03)*weight, 2)\n#   ))\n```\n:::\n\n\n## plotting data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblue_col <- \"cornflowerblue\"\ngreen_col <- \"darkgreen\"\nred_col <- \"maroon\"\n\nstriped_col <- \"grey1\"\nspotted_col <- \"grey50\"\nnone_col <- \"grey80\"\n\nggplot(data = df, aes(x = color, y = toxicity, color = color, fill = color)) +\n  geom_jitter(width = 0.2, height = 0, alpha = 0.3) +\n  scale_color_manual(values = c(\"blue\" = blue_col, \"green\" = green_col, \"red\" = red_col)) +\n  scale_fill_manual(values = c(\"blue\" = blue_col, \"green\" = green_col, \"red\" = red_col)) +\n  stat_summary(geom = \"pointrange\", fun = mean, fun.min = function(x) mean(x) - sd(x), fun.max = function(x) mean(x) + sd(x), shape = 21, size = 1) +\n #  geom_point(position = position_jitter(width = 0.2, height = 0, seed = 666), alpha = 0.3) +\n  labs(title = \"Color\") +\n  theme(legend.position = \"none\",\n        axis.title.x = element_blank(),\n        text = element_text(size = 22))\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-plots-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = df, aes(x = weight, y = toxicity)) +\n  geom_point() +\n  # geom_smooth(method = \"lm\") +\n  labs(title = \"Weight\") +\n  theme(legend.position = \"none\",\n        axis.title.x = element_blank(),\n        text = element_text(size = 22))\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-plots-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = df, aes(x = weight, y = toxicity, color = color)) +\n  geom_point() +\n  scale_color_manual(values = c(\"blue\" = blue_col, \"green\" = green_col, \"red\" = red_col)) +\n  geom_smooth(method = \"lm\") +\n  labs(title = \"Weight\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-plots-3.png){width=672}\n:::\n\n```{.r .cell-code}\nhead(df, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 3\n   weight toxicity color\n    <dbl>    <dbl> <fct>\n 1   3.08     7.00 red  \n 2   3.2      7.37 red  \n 3   2.96     7.30 blue \n 4   3.2      7.34 red  \n 5   2.78     7.33 blue \n 6   3.08     6.88 red  \n 7   2.87     7.20 blue \n 8   2.92     6.61 blue \n 9   2.82     6.70 blue \n10   3        7.26 red  \n```\n\n\n:::\n:::\n\n\n## model\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(toxicity ~ weight + color, \n             data = df)\n\nmodel2 <- lm(toxicity ~ weight * color, \n             data = df)\n\nsimulateResiduals(model1, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-model-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.412 0.472 0.344 0.444 0.92 0.212 0.54 0.004 0.076 0.956 0.4 0.888 0.296 0.612 0.808 0.5 0.444 0 0.424 0.852 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nsimulateResiduals(model2, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-model-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.428 0.616 0.348 0.56 0.896 0.212 0.516 0.004 0.048 0.94 0.524 0.88 0.304 0.568 0.864 0.42 0.468 0.004 0.58 0.736 ...\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_model(model2)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-model-3.png){width=672}\n:::\n\n```{.r .cell-code}\ntestOutliers(model2)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-model-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDHARMa outlier test based on exact binomial test with approximate\n\texpectations\n\ndata:  model2\noutliers at both margin(s) = 1, observations = 87, p-value = 0.5014\nalternative hypothesis: true probability of success is not equal to 0.007968127\n95 percent confidence interval:\n 0.0002909669 0.0623843203\nsample estimates:\nfrequency of outliers (expected: 0.00796812749003984 ) \n                                            0.01149425 \n```\n\n\n:::\n:::\n\n\n## diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(model1)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-diagnostics-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(model2)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-diagnostics-2.png){width=672}\n:::\n:::\n\n\n## model summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = toxicity ~ weight + color, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.69729 -0.13129 -0.01201  0.15783  0.56205 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.48954    0.91692  -0.534    0.595    \nweight       2.45758    0.29881   8.224 2.32e-12 ***\ncolorblue    0.62269    0.07556   8.241 2.15e-12 ***\ncolorgreen   2.11904    0.06823  31.056  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2429 on 83 degrees of freedom\nMultiple R-squared:  0.9306,\tAdjusted R-squared:  0.9281 \nF-statistic:   371 on 3 and 83 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = toxicity ~ weight * color, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.69784 -0.11377  0.00261  0.12840  0.64018 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        1.12675    1.52961   0.737  0.46348    \nweight             1.93021    0.49888   3.869  0.00022 ***\ncolorblue          0.05147    2.05984   0.025  0.98013    \ncolorgreen        -2.95838    2.26526  -1.306  0.19526    \nweight:colorblue   0.16966    0.68677   0.247  0.80550    \nweight:colorgreen  1.68034    0.74728   2.249  0.02725 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2372 on 81 degrees of freedom\nMultiple R-squared:  0.9354,\tAdjusted R-squared:  0.9314 \nF-statistic: 234.5 on 5 and 81 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel.sel(model1, model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel selection table \n         (Int) clr   wgh clr:wgh df logLik AICc delta\nmodel2  1.1270   + 0.682       +  7  4.830  5.8  0.00\nmodel1 -0.4895   + 0.318          5  1.729  7.3  1.53\nModels ranked by AICc(x) \n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(model1,\n          terms = c(\"weight [2:4 by = 0.01]\", \n                    \"color\")) %>% \n  plot(show_data = TRUE,\n       limit_range = TRUE) +\n  scale_color_manual(values = c(\"green\" = green_col, \n                                \"red\" = red_col, \n                                \"blue\" = blue_col)) +\n  scale_fill_manual(values = c(\"green\" = green_col, \n                               \"red\" = red_col, \n                               \"blue\" = blue_col)) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggpredict(model2,\n          terms = c(\"weight [2:4 by = 0.01]\", \n                    \"color\")) %>% \n  plot(show_data = TRUE,\n       limit_range = TRUE) +\n  scale_color_manual(values = c(\"green\" = green_col, \n                                \"red\" = red_col, \n                                \"blue\" = blue_col)) +\n  scale_fill_manual(values = c(\"green\" = green_col, \n                               \"red\" = red_col, \n                               \"blue\" = blue_col)) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\n$$\n\\hat{y}_h \\pm t_{(1-\\alpha/2, n-2)}*\\sqrt{MSE*(\\frac{1}{n}+\\frac{(x_h-\\bar{x})^2}{\\sum(x_i-\\bar{x})^2})}\n$$\n\n$$\nMSE = \\frac{\\sum(y_i-\\hat{y})^2}{n}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(model2, conf.int = TRUE, conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 7\n  term              estimate std.error statistic  p.value conf.low conf.high\n  <chr>                <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n1 (Intercept)         1.13       1.53     0.737  0.463      -1.92       4.17\n2 weight              1.93       0.499    3.87   0.000220    0.938      2.92\n3 colorblue           0.0515     2.06     0.0250 0.980      -4.05       4.15\n4 colorgreen         -2.96       2.27    -1.31   0.195      -7.47       1.55\n5 weight:colorblue    0.170      0.687    0.247  0.806      -1.20       1.54\n6 weight:colorgreen   1.68       0.747    2.25   0.0273      0.193      3.17\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_summary <- summary(model2)\nc(\"lower\" = model_summary$coef[2,1] - qt(0.975, df = model_summary$df[2]) * model_summary$coef[2, 2],\n  \"upper\" = model_summary$coef[2,1] + qt(0.975, df = model_summary$df[2]) * model_summary$coef[2, 2])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    lower     upper \n0.9376025 2.9228220 \n```\n\n\n:::\n:::\n\n\nConfidence interval for a single coefficient:\nin words: estimate plus or minus the t-value at your confidence level * standard error\n\n\n\n",
    "supporting": [
      "lecture_week-08_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}