{
  "hash": "5a7ce40beb201f72a4cfd26ee789d558",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 8 figures - Lectures 14 and 15\"\neditor: source\nfreeze: auto\nexecute:\n  message: false\n  warning: false\nformat:\n  html: \n    code-fold: true\nauthor:\n  - name: An Bui\n    url: https://an-bui.com/\n    affiliation: UC Santa Barbara, Ecology, Evolution, and Marine Biology\n    affiliation-url: https://www.eemb.ucsb.edu/\npublished-title: \"Lecture date\"\ndate: 2024-05-20\ndate-modified: last-modified\ncategories: [multiple linear regression, AIC]\ncitation:\n  url: https://spring-2024.envs-193ds.com/lecture/lecture_week-08.html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# cleaning\nlibrary(tidyverse)\n\n# visualization\ntheme_set(theme_classic() +\n            theme(panel.grid = element_blank(),\n                  axis.text = element_text(size = 18),\n                  axis.title = element_text(size = 18),\n                  text = element_text(family = \"Lato\")))\nlibrary(patchwork)\nlibrary(ggeffects)\nlibrary(flextable)\nlibrary(GGally)\n\n# data\nlibrary(palmerpenguins)\n\n# analysis\nlibrary(car)\nlibrary(performance)\nlibrary(broom)\nlibrary(DHARMa)\nlibrary(MuMIn)\n```\n:::\n\n\n# multiple linear regression equation\n\n$$\n\\begin{align}\ny &= \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + ... \\beta_kx_k + \\epsilon\n\\end{align}\n$$\n\n# formulas\n\n## sum of squares for linear regression\n\n### regression (or model)\n\n$$\nSS_{reg} = \\sum_{i = 1}^{n}(\\hat{y} - \\bar{y})^2\n$$\n\n### error\n\n$$\nSS_{err} = \\sum_{i = 1}^{n}(y_i - \\hat{y})^2\n$$\n\n### total \n\n$$\nSS_{tot} = \\sum_{i = 1}^n(y_i - \\bar{y})\n$$\n\n## mean square\n\n### regression\n\n$$\nMS_{reg} = \\frac{SS_{reg}}{1}\n$$\n\n### error\n\n$$\nMS_{err} = \\frac{SS_{err}}{n - 2}\n$$\n\n## F-statistic\n\n$$\nF = \\frac{MS_{reg}}{MS_{err}}\n$$\n\n# soil example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\n# sample size\nn <- 64\n\nsoil_df <- tibble(\n  # compaction\n  force_mpa = round(rnorm(n = n, mean = 0.7, sd = 0.03), 3),\n  # root length\n  root_mm = round(rnorm(n = n, mean = -1, sd = 0.02)*force_mpa, 3) + 5\n) \n\nggplot(data = soil_df,\n       aes(x = force_mpa,\n           y = root_mm)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsoil_lm <- lm(root_mm ~ force_mpa,\n              data = soil_df)\n\npar(mfrow = c(2, 2))\nplot(soil_lm)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(soil_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = root_mm ~ force_mpa, data = soil_df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.033749 -0.009088  0.000251  0.008962  0.028832 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   4.9569     0.0357   138.9   <2e-16 ***\nforce_mpa    -0.9400     0.0511   -18.4   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.01338 on 62 degrees of freedom\nMultiple R-squared:  0.8451,\tAdjusted R-squared:  0.8427 \nF-statistic: 338.4 on 1 and 62 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(soil_df$root_mm, soil_df$force_mpa)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  soil_df$root_mm and soil_df$force_mpa\nt = -18.395, df = 62, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9503672 -0.8701422\nsample estimates:\n       cor \n-0.9193192 \n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_preds <- ggpredict(soil_lm,\n                         terms = \"force_mpa [0.63:0.77 by = 0.01]\") \n\nggpredict(soil_lm,\n          terms = \"force_mpa [0.63:0.77 by = 0.01]\") %>% \n  plot(show_data = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\nflextable::as_flextable(soil_lm) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-dcb582ba{}.cl-dc989c36{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dc989c4a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcb2bf3a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dcb2bf4e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dcb2ce30{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce31{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce3a{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce3b{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce44{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce4e{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce4f{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce50{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce58{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce62{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce63{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce6c{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce6d{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce76{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce77{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce80{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce8a{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce8b{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce94{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce9e{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ce9f{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2cea8{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2cea9{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ceb2{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ceb3{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2cebc{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2cec6{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2cec7{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2ceda{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcb2cedb{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-dcb582ba'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-dcb2ce30\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\"></span></p></th><th class=\"cl-dcb2ce31\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">Estimate</span></p></th><th class=\"cl-dcb2ce3a\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">Standard Error</span></p></th><th class=\"cl-dcb2ce3b\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">t value</span></p></th><th class=\"cl-dcb2ce44\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">Pr(&gt;|t|)</span></p></th><th class=\"cl-dcb2ce4e\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\"></span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dcb2ce4f\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\">(Intercept)</span></p></td><td class=\"cl-dcb2ce50\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">4.957</span></p></td><td class=\"cl-dcb2ce58\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">0.036</span></p></td><td class=\"cl-dcb2ce62\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">138.866</span></p></td><td class=\"cl-dcb2ce63\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">0.0000</span></p></td><td class=\"cl-dcb2ce6c\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\">***</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dcb2ce6d\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\">force_mpa</span></p></td><td class=\"cl-dcb2ce76\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">-0.940</span></p></td><td class=\"cl-dcb2ce77\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">0.051</span></p></td><td class=\"cl-dcb2ce80\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">-18.395</span></p></td><td class=\"cl-dcb2ce8a\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c36\">0.0000</span></p></td><td class=\"cl-dcb2ce8b\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\">***</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcb2ce94\"><p class=\"cl-dcb2bf4e\"><span class=\"cl-dc989c4a\">Signif. codes: 0 &lt;= '***' &lt; 0.001 &lt; '**' &lt; 0.01 &lt; '*' &lt; 0.05</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcb2ceb3\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcb2ceb3\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\">Residual standard error: 0.01338 on 62 degrees of freedom</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcb2ceb3\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\">Multiple R-squared: 0.8451, Adjusted R-squared: 0.8427</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcb2ceb3\"><p class=\"cl-dcb2bf3a\"><span class=\"cl-dc989c36\">F-statistic: 338.4 on 62 and 1 DF, p-value: 0.0000</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n\n```{.r .cell-code}\nflextable::as_flextable(soil_lm) %>% \n  set_formatter(\n    # special function to represent p < 0.001\n    values = list(\"p.value\" = function(x){ \n      z <- scales::label_pvalue()(x)\n      z[!is.finite(x)] <- \"\"\n      z\n    })\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-dcd7201e{}.cl-dcd32f0e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcd32f18{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcd4c18e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dcd4c198{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dcd4ce4a{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce54{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce5e{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce5f{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce68{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce69{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce6a{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce72{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce73{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce7c{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce7d{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce86{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce87{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce90{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce91{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce9a{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ce9b{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4cea4{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4cea5{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4cea6{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ceae{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ceaf{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ceb0{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ceb8{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ceb9{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4ceba{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4cec2{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4cec3{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4cecc{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcd4cecd{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-dcd7201e'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-dcd4ce4a\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\"></span></p></th><th class=\"cl-dcd4ce54\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">Estimate</span></p></th><th class=\"cl-dcd4ce5e\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">Standard Error</span></p></th><th class=\"cl-dcd4ce5f\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">t value</span></p></th><th class=\"cl-dcd4ce68\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">Pr(&gt;|t|)</span></p></th><th class=\"cl-dcd4ce69\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\"></span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dcd4ce6a\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\">(Intercept)</span></p></td><td class=\"cl-dcd4ce72\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">4.957</span></p></td><td class=\"cl-dcd4ce73\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">0.036</span></p></td><td class=\"cl-dcd4ce7c\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">138.866</span></p></td><td class=\"cl-dcd4ce7d\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">&lt;0.001</span></p></td><td class=\"cl-dcd4ce86\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\">***</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dcd4ce87\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\">force_mpa</span></p></td><td class=\"cl-dcd4ce90\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">-0.940</span></p></td><td class=\"cl-dcd4ce91\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">0.051</span></p></td><td class=\"cl-dcd4ce9a\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">-18.395</span></p></td><td class=\"cl-dcd4ce9b\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f0e\">&lt;0.001</span></p></td><td class=\"cl-dcd4cea4\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\">***</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcd4cea5\"><p class=\"cl-dcd4c198\"><span class=\"cl-dcd32f18\">Signif. codes: 0 &lt;= '***' &lt; 0.001 &lt; '**' &lt; 0.01 &lt; '*' &lt; 0.05</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcd4ceb9\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcd4ceb9\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\">Residual standard error: 0.01338 on 62 degrees of freedom</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcd4ceb9\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\">Multiple R-squared: 0.8451, Adjusted R-squared: 0.8427</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"6\"class=\"cl-dcd4ceb9\"><p class=\"cl-dcd4c18e\"><span class=\"cl-dcd32f0e\">F-statistic: 338.4 on 62 and 1 DF, p-value: 0.0000</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n:::\n\n\n\n# plant example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\n# sample size\nn <- 64\nplant_df <- tibble(\n  # predictor variables\n  temperature = round(rnorm(n = n, mean = 28, sd = 1), digits = 1),\n  light = round(rnorm(n = n, mean = 1, sd = 0.2), digits = 1),\n  ph = rnorm(n = n, mean = 7, sd = 0.01),\n  \n  # response: growth in cm/week\n  growth = light*rnorm(n = n, mean = 0.3, sd = 0.1) + temperature/round(rnorm(n = n, mean = 5, sd = 0.1))\n) \n\nggplot(data = plant_df,\n       aes(x = temperature,\n           y = growth)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = plant_df,\n       aes(x = ph,\n           y = light)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = plant_df,\n       aes(x = light,\n           y = growth)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplant_lm <- lm(growth ~ temperature + ph + light,\n               data = plant_df)\nsimulateResiduals(plant_lm) %>% plot()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-4.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(plant_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = growth ~ temperature + ph + light, data = plant_df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23209 -0.06571  0.01010  0.06173  0.19950 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -6.67140    6.80194  -0.981    0.331    \ntemperature  0.19626    0.01058  18.558  < 2e-16 ***\nph           0.96241    0.96806   0.994    0.324    \nlight        0.35196    0.05939   5.926 1.63e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.0911 on 60 degrees of freedom\nMultiple R-squared:  0.8759,\tAdjusted R-squared:  0.8696 \nF-statistic: 141.1 on 3 and 60 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(plant_lm,\n          terms = c(\"temperature\")) %>% \n  plot(show_data = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-5.png){width=672}\n:::\n\n```{.r .cell-code}\nggpredict(plant_lm,\n          terms = c(\"ph\")) %>% \n  plot(show_data = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-6.png){width=672}\n:::\n\n```{.r .cell-code}\nggpredict(plant_lm,\n          terms = c(\"light\")) %>% \n  plot(show_data = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-data-7.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplant_model <- lm(growth ~ light + temperature, \n                  data = plant_df)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsimulateResiduals(plant_model,\n                  plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-diagnostics-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0 0.756 0.792 0.816 0.06 0.132 0.408 0.708 0.988 0.892 0.452 0.876 0.644 0.512 0.984 0.904 0.936 0.56 0.58 0.724 ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(plant_model)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-model-performance-1.png){width=672}\n:::\n\n```{.r .cell-code}\npairs(plant_df, upper.panel = NULL)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-model-performance-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggpairs(plant_df)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/plant-model-performance-3.png){width=672}\n:::\n\n```{.r .cell-code}\ncor(plant_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            temperature       light          ph      growth\ntemperature  1.00000000  0.15540780 -0.06657697  0.89551840\nlight        0.15540780  1.00000000 -0.04769987  0.40397013\nph          -0.06657697 -0.04769987  1.00000000 -0.02466729\ngrowth       0.89551840  0.40397013 -0.02466729  1.00000000\n```\n\n\n:::\n\n```{.r .cell-code}\nvif(plant_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      light temperature \n   1.024749    1.024749 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(plant_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = growth ~ light + temperature, data = plant_df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.227058 -0.071297  0.006266  0.063745  0.197573 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  0.08464    0.29166   0.290    0.773    \nlight        0.34972    0.05934   5.894 1.76e-07 ***\ntemperature  0.19563    0.01056  18.534  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.09109 on 61 degrees of freedom\nMultiple R-squared:  0.8738,\tAdjusted R-squared:  0.8697 \nF-statistic: 211.2 on 2 and 61 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# anova(plant_model)\n```\n:::\n\n\nFor example, temperature F-value:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n2.85039/0.0083\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 343.4205\n```\n\n\n:::\n:::\n\n\n$$\n\\begin{align}\nF &= \\frac{2.85039}{0.00830} \\\\\n&= 343.4205\n\\end{align}\n$$\n\n# dummy variable examples\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  herbivores = sample(x = c(\"absent\", \"present\"), size = 10, replace = TRUE, prob = c(0.5, 0.5))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 1\n   herbivores\n   <chr>     \n 1 present   \n 2 present   \n 3 present   \n 4 present   \n 5 present   \n 6 absent    \n 7 present   \n 8 present   \n 9 absent    \n10 present   \n```\n\n\n:::\n\n```{.r .cell-code}\ntibble(\n  fertilizer = sample(x = c(\"low\", \"medium\", \"high\"), size = 10, replace = TRUE, prob = c(0.3, 0.3, 0.3))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 1\n   fertilizer\n   <chr>     \n 1 low       \n 2 high      \n 3 low       \n 4 low       \n 5 low       \n 6 medium    \n 7 medium    \n 8 medium    \n 9 high      \n10 low       \n```\n\n\n:::\n\n```{.r .cell-code}\ndf <- tibble(\n  year = sample(x = c(\"1st\", \"2nd\", \"3rd\", \"4th\", \"5th\"), size = 20, replace = TRUE, prob = c(0.2, 0.2, 0.2, 0.2, 0.2))\n) %>% \n  mutate(year = as_factor(year),\n         year = fct_relevel(year, \"1st\", \"2nd\", \"3rd\", \"4th\", \"5th\"))\n\ndf \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20 × 1\n   year \n   <fct>\n 1 2nd  \n 2 4th  \n 3 1st  \n 4 1st  \n 5 2nd  \n 6 2nd  \n 7 3rd  \n 8 2nd  \n 9 3rd  \n10 4th  \n11 3rd  \n12 5th  \n13 2nd  \n14 3rd  \n15 4th  \n16 1st  \n17 5th  \n18 5th  \n19 4th  \n20 5th  \n```\n\n\n:::\n\n```{.r .cell-code}\nstr(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [20 × 1] (S3: tbl_df/tbl/data.frame)\n $ year: Factor w/ 5 levels \"1st\",\"2nd\",\"3rd\",..: 2 4 1 1 2 2 3 2 3 4 ...\n```\n\n\n:::\n:::\n\n\n## plant growth dummy variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# humidity units: %\n# plant growth: cm / week\n\nlow_col <- \"#2176ae\"\nmedium_col <- \"#fbb13c\"\nhigh_col <- \"#fe6847\"\n\nn <- 30\nset.seed(10)\nplant_df <- tibble(\n  humidity = round(rnorm(n = n, mean = 60, sd = 15), 0),\n  low = humidity*rnorm(n = n, mean = 0.025, sd = 0.012) + 1,\n  medium = humidity*rnorm(n = n, mean = 0.025, sd = 0.015) + 1.5,\n  high = humidity*rnorm(n = n, mean = 0.025, sd = 0.017) + 2\n) %>% \n  pivot_longer(cols = low:high,\n               names_to = \"fertilizer\", \n               values_to = \"growth\") %>% \n  mutate(fertilizer = fct_relevel(fertilizer, \"low\", \"medium\", \"high\"))\n\n# gives you a random sample\nsample_n(plant_df, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 3\n   humidity fertilizer growth\n      <dbl> <fct>       <dbl>\n 1       71 high         3.01\n 2       42 high         1.90\n 3       58 medium       1.92\n 4       50 low          3.07\n 5       56 low          1.96\n 6       61 low          2.50\n 7       47 medium       4.24\n 8       54 low          2.86\n 9       77 low          3.93\n10       39 medium       1.99\n```\n\n\n:::\n\n```{.r .cell-code}\n# look at the structure\nstr(plant_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [90 × 3] (S3: tbl_df/tbl/data.frame)\n $ humidity  : num [1:90] 60 60 60 57 57 57 39 39 39 51 ...\n $ fertilizer: Factor w/ 3 levels \"low\",\"medium\",..: 1 2 3 1 2 3 1 2 3 1 ...\n $ growth    : num [1:90] 1.17 1.89 3.08 2.37 2.53 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(data = plant_df,\n       aes(x = humidity,\n           y = growth)) +\n  geom_point() \n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = plant_df,\n       aes(x = fertilizer,\n           y = growth,\n           color = fertilizer)) +\n  geom_jitter(width = 0.2,\n              height = 0,\n              alpha = 0.3) +\n  stat_summary(fun.data = mean_cl_normal,\n               geom = \"pointrange\",\n               size = 1,\n               linewidth = 1) +\n  scale_color_manual(values = c(low_col, medium_col, high_col)) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplant_df %>% \n  group_by(fertilizer) %>% \n  summarize(mean = mean(growth))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  fertilizer  mean\n  <fct>      <dbl>\n1 low         2.25\n2 medium      2.82\n3 high        3.51\n```\n\n\n:::\n\n```{.r .cell-code}\nplant_df %>% \n  summarize(mean = mean(growth))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n   mean\n  <dbl>\n1  2.86\n```\n\n\n:::\n\n```{.r .cell-code}\nplant_lm <- lm(growth ~ humidity + fertilizer,\n               data = plant_df)\n\n# am i broken because i can't look at anything other than dharma residuals\nsimulateResiduals(plant_lm) %>% plot()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(plant_lm)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n\n```{.r .cell-code}\nggpredict(plant_lm,\n          terms = c(\"humidity\",\n                    \"fertilizer\")) %>% \n  plot(show_data = TRUE) +\n  scale_color_manual(values = c(low_col, medium_col, high_col)) +\n  scale_fill_manual(values = c(low_col, medium_col, high_col)) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-5.png){width=672}\n:::\n\n```{.r .cell-code}\nggpredict(plant_lm,\n          terms = c(\"humidity\")) %>% \n  plot(show_data = TRUE) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-6.png){width=672}\n:::\n\n```{.r .cell-code}\nggpredict(lm(growth ~ humidity, data = plant_df),\n          terms = \"humidity\") %>% \n  plot(show_data = TRUE) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-4-7.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(plant_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = growth ~ humidity + fertilizer, data = plant_df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.7361 -0.5220  0.1129  0.5353  1.6649 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      1.280788   0.390802   3.277  0.00151 ** \nhumidity         0.017697   0.006615   2.675  0.00894 ** \nfertilizermedium 0.573791   0.207205   2.769  0.00688 ** \nfertilizerhigh   1.264891   0.207205   6.105 2.88e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.8025 on 86 degrees of freedom\nMultiple R-squared:  0.3411,\tAdjusted R-squared:  0.3182 \nF-statistic: 14.84 on 3 and 86 DF,  p-value: 7.19e-08\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(lm(growth ~ humidity, data = plant_df))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = growth ~ humidity, data = plant_df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.7902 -0.7698 -0.0693  0.5993  1.9402 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 1.893683   0.440513   4.299 4.42e-05 ***\nhumidity    0.017697   0.007833   2.259   0.0263 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9502 on 88 degrees of freedom\nMultiple R-squared:  0.05483,\tAdjusted R-squared:  0.04409 \nF-statistic: 5.105 on 1 and 88 DF,  p-value: 0.02633\n```\n\n\n:::\n:::\n\n\n\n# frog example\n\n## generating data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\nfrog_n <- 87\n\nfrog_df <- tibble(\n  weight = (round(rnorm(n = frog_n, mean = 3, sd = 0.1), 2)),\n  blue = round(rnorm(n = frog_n, mean = 2.5, sd = 0.09)*(round(rnorm(n = frog_n, mean = 3, sd = 0.1), 2)), 2),\n  green = round(rnorm(n = frog_n, mean = 3, sd = 0.05)*(round(rnorm(n = frog_n, mean = 3, sd = 0.1), 2)), 2),\n  red = round(rnorm(n = frog_n, mean = 2.3, sd = 0.05)*(round(rnorm(n = frog_n, mean = 3, sd = 0.1), 2)), 2)\n) %>% \n  pivot_longer(cols = blue:red,\n               names_to = \"color\",\n               values_to = \"toxicity\")\n\ndf <- cbind(\n  # predictor variables\n  # color = sample(x = c(\"blue\", \"green\", \"red\"), size = frog_n, replace = TRUE, prob = c(0.3, 0.3, 0.3)),\n  weight = (round(rnorm(n = frog_n, mean = 3, sd = 0.1), 2))\n  #pattern = sample(x = c(\"striped\", \"spotted\", \"none\"), size = frog_n, replace = TRUE, prob = c(0.3, 0.3, 0.3))\n) %>%\n  as_tibble() %>%\n  mutate(toxicity = round(rnorm(n = frog_n, mean = 1.5, sd = 0.06)*weight, 3)) %>%\n  mutate(color = case_when(\n    between(toxicity, 2.5, 4.4) ~ \"blue\",\n    between(toxicity, 4.4, 4.6) ~ \"green\",\n    between(toxicity, 4.6, 5.5) ~ \"red\"\n  )) %>% \n  mutate(toxicity = case_when(\n    color == \"blue\" ~ round(rnorm(n = frog_n, mean = 2.5, sd = 0.09)*weight, 3),\n    color == \"green\" ~ round(rnorm(n = frog_n, mean = 3, sd = 0.05)*weight, 3),\n    color == \"red\" ~ round(rnorm(n = frog_n, mean = 2.3, sd = 0.05)*weight, 3)\n  )) %>% \n  mutate(color = as_factor(color),\n         color = fct_relevel(color, \"red\", \"blue\", \"green\"))\n\n\n# df <- cbind(\n#   color = sample(x = c(\"blue\", \"green\", \"red\"), size = frog_n, replace = TRUE, prob = c(0.3, 0.3, 0.3))\n# ) %>% \n#   as_tibble() %>% \n#   mutate(weight = (round(rnorm(n = frog_n, mean = 3.5, sd = 0.1), 2))) %>% \n#   mutate(toxicity = case_when(\n#     color == \"blue\" ~ round(rnorm(n = frog_n, mean = 3, sd = 0.4)*weight, 2),\n#     color == \"green\" ~ round(rnorm(n = frog_n, mean = 2, sd = 0.5)*weight, 2),\n#     color == \"red\" ~ round(rnorm(n = frog_n, mean = 1, sd = 0.03)*weight, 2)\n#   ))\n```\n:::\n\n\n## plotting data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblue_col <- \"cornflowerblue\"\ngreen_col <- \"darkgreen\"\nred_col <- \"maroon\"\n\nstriped_col <- \"grey1\"\nspotted_col <- \"grey50\"\nnone_col <- \"grey80\"\n\nggplot(data = frog_df, aes(x = color, y = toxicity, color = color, fill = color)) +\n  geom_jitter(width = 0.2, height = 0, alpha = 0.3) +\n  scale_color_manual(values = c(\"blue\" = blue_col, \"green\" = green_col, \"red\" = red_col)) +\n  scale_fill_manual(values = c(\"blue\" = blue_col, \"green\" = green_col, \"red\" = red_col)) +\n  stat_summary(geom = \"pointrange\", \n               fun = mean, \n               fun.min = function(x) mean(x) - sd(x), \n               fun.max = function(x) mean(x) + sd(x), \n               shape = 21, \n               size = 1) +\n #  geom_point(position = position_jitter(width = 0.2, height = 0, seed = 666), alpha = 0.3) +\n  labs(title = \"Color\") +\n  theme(legend.position = \"none\",\n        axis.title.x = element_blank(),\n        text = element_text(size = 22))\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-plots-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = frog_df, aes(x = weight, y = toxicity)) +\n  geom_point() +\n  # geom_smooth(method = \"lm\") +\n  labs(title = \"Weight\") +\n  theme(legend.position = \"none\",\n        axis.title.x = element_blank(),\n        text = element_text(size = 22))\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-plots-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = frog_df, aes(x = weight, y = toxicity, color = color)) +\n  geom_point() +\n  scale_color_manual(values = c(\"blue\" = blue_col, \"green\" = green_col, \"red\" = red_col)) +\n  geom_smooth(method = \"lm\") +\n  labs(title = \"Weight\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-plots-3.png){width=672}\n:::\n\n```{.r .cell-code}\nhead(df, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 3\n   weight toxicity color\n    <dbl>    <dbl> <fct>\n 1   3.18     8.29 blue \n 2   3.02     9.24 green\n 3   3.01     8.75 green\n 4   3.07     7.24 red  \n 5   2.98     7.47 blue \n 6   2.94     8.89 green\n 7   2.95     7.26 blue \n 8   2.91     7.25 blue \n 9   2.95     6.61 red  \n10   3.06     8.96 green\n```\n\n\n:::\n:::\n\n\n## model\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(toxicity ~ weight + color, \n             data = frog_df)\n\nmodel2 <- lm(toxicity ~ weight * color, \n             data = frog_df)\n\nsimulateResiduals(model1, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-model-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.804 0.556 0.336 0.376 0.5 0.56 0.076 0.74 0.308 0.008 0.416 0.828 0.684 0.204 0.272 0.66 0.172 0.208 0.604 0.708 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nsimulateResiduals(model2, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-model-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.82 0.536 0.336 0.42 0.436 0.572 0.076 0.74 0.3 0.012 0.368 0.84 0.628 0.256 0.244 0.692 0.144 0.212 0.58 0.752 ...\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_model(model2)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-model-3.png){width=672}\n:::\n\n```{.r .cell-code}\ntestOutliers(model2)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-model-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDHARMa outlier test based on exact binomial test with approximate\n\texpectations\n\ndata:  model2\noutliers at both margin(s) = 1, observations = 261, p-value = 0.7287\nalternative hypothesis: true probability of success is not equal to 0.007968127\n95 percent confidence interval:\n 9.699839e-05 2.116127e-02\nsample estimates:\nfrequency of outliers (expected: 0.00796812749003984 ) \n                                           0.003831418 \n```\n\n\n:::\n:::\n\n\n## diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(model1)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-diagnostics-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(model2)\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/frog-diagnostics-2.png){width=672}\n:::\n:::\n\n\n## model summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = toxicity ~ weight + color, data = frog_df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.90113 -0.21865 -0.00068  0.22588  0.90229 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  7.71921    0.58381  13.222   <2e-16 ***\nweight      -0.07811    0.19467  -0.401    0.689    \ncolorgreen   1.48908    0.05049  29.490   <2e-16 ***\ncolorred    -0.56874    0.05049 -11.263   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.333 on 257 degrees of freedom\nMultiple R-squared:  0.8733,\tAdjusted R-squared:  0.8718 \nF-statistic: 590.6 on 3 and 257 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = toxicity ~ weight * color, data = frog_df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.91522 -0.22141 -0.00686  0.21240  0.87930 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         8.2941     1.0119   8.196 1.21e-14 ***\nweight             -0.2702     0.3379  -0.800    0.425    \ncolorgreen          0.1204     1.4311   0.084    0.933    \ncolorred           -0.9248     1.4311  -0.646    0.519    \nweight:colorgreen   0.4573     0.4778   0.957    0.339    \nweight:colorred     0.1189     0.4778   0.249    0.804    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3337 on 255 degrees of freedom\nMultiple R-squared:  0.8738,\tAdjusted R-squared:  0.8713 \nF-statistic: 353.1 on 5 and 255 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel.sel(model1, model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel selection table \n       (Int) clr   wgh clr:wgh df  logLik  AICc delta\nmodel1 7.719   + 0.832          5 -81.355 172.9   0.0\nmodel2 8.294   + 0.168       +  7 -80.851 176.1   3.2\nModels ranked by AICc(x) \n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(model1,\n          terms = c(\"weight [2:4 by = 0.01]\", \n                    \"color\")) %>% \n  plot(show_data = TRUE,\n       limit_range = TRUE) +\n  scale_color_manual(values = c(\"green\" = green_col, \n                                \"red\" = red_col, \n                                \"blue\" = blue_col)) +\n  scale_fill_manual(values = c(\"green\" = green_col, \n                               \"red\" = red_col, \n                               \"blue\" = blue_col)) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggpredict(model2,\n          terms = c(\"weight [2:4 by = 0.01]\", \n                    \"color\")) %>% \n  plot(show_data = TRUE,\n       limit_range = TRUE) +\n  scale_color_manual(values = c(\"green\" = green_col, \n                                \"red\" = red_col, \n                                \"blue\" = blue_col)) +\n  scale_fill_manual(values = c(\"green\" = green_col, \n                               \"red\" = red_col, \n                               \"blue\" = blue_col)) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](lecture_week-08_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n$$\n\\hat{y}_h \\pm t_{(1-\\alpha/2, n-2)}*\\sqrt{MSE*(\\frac{1}{n}+\\frac{(x_h-\\bar{x})^2}{\\sum(x_i-\\bar{x})^2})}\n$$\n\n$$\nMSE = \\frac{\\sum(y_i-\\hat{y})^2}{n}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(model2, conf.int = TRUE, conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 7\n  term              estimate std.error statistic  p.value conf.low conf.high\n  <chr>                <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n1 (Intercept)          8.29      1.01     8.20   1.21e-14    6.30     10.3  \n2 weight              -0.270     0.338   -0.800  4.25e- 1   -0.936     0.395\n3 colorgreen           0.120     1.43     0.0841 9.33e- 1   -2.70      2.94 \n4 colorred            -0.925     1.43    -0.646  5.19e- 1   -3.74      1.89 \n5 weight:colorgreen    0.457     0.478    0.957  3.39e- 1   -0.484     1.40 \n6 weight:colorred      0.119     0.478    0.249  8.04e- 1   -0.822     1.06 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_summary <- summary(model2)\nc(\"lower\" = model_summary$coef[2,1] - qt(0.975, df = model_summary$df[2]) * model_summary$coef[2, 2],\n  \"upper\" = model_summary$coef[2,1] + qt(0.975, df = model_summary$df[2]) * model_summary$coef[2, 2])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     lower      upper \n-0.9355103  0.3951563 \n```\n\n\n:::\n:::\n\n\nConfidence interval for a single coefficient:\nin words: estimate plus or minus the t-value at your confidence level * standard error\n\n\n\n",
    "supporting": [
      "lecture_week-08_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}