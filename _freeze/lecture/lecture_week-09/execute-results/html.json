{
  "hash": "af12dd22c5f17c8deb15c8f3fda3677f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 9 figures - Lecture 16\"\neditor: source\nfreeze: auto\nexecute:\n  message: false\n  warning: false\nformat:\n  html: \n    code-fold: true\nauthor:\n  - name: An Bui\n    url: https://an-bui.com/\n    affiliation: UC Santa Barbara, Ecology, Evolution, and Marine Biology\n    affiliation-url: https://www.eemb.ucsb.edu/\npublished-title: \"Lecture date\"\ndate: 2024-05-29\ndate-modified: last-modified\ncategories: [multiple linear regression, AIC]\ncitation:\n  url: https://spring-2024.envs-193ds.com/lecture/lecture_week-08.html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# cleaning\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(here)\nlibrary(janitor)\n\n# visualization\ntheme_set(theme_classic() +\n            theme(panel.grid = element_blank(),\n                  axis.text = element_text(size = 18),\n                  axis.title = element_text(size = 18),\n                  text = element_text(family = \"Lato\")))\nlibrary(patchwork)\nlibrary(ggeffects)\nlibrary(flextable)\nlibrary(GGally)\n\n# data\nlibrary(palmerpenguins)\n\n# analysis\nlibrary(car)\nlibrary(performance)\nlibrary(broom)\nlibrary(DHARMa)\nlibrary(MuMIn)\nlibrary(lmtest)\nlibrary(equatiomatic)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndrought_exp <- read_xlsx(path = here(\"data\", \n                                     \"Valliere_etal_EcoApps_Data.xlsx\"),\n                         sheet = \"First Harvest\")\n\n# cleaning\ndrought_exp_clean <- drought_exp %>% \n  clean_names() %>% # nicer column names\n  mutate(species_name = case_when( # adding column with species scientific names\n    species == \"ENCCAL\" ~ \"Encelia californica\", # bush sunflower\n    species == \"ESCCAL\" ~ \"Eschscholzia californica\", # California poppy\n    species == \"PENCEN\" ~ \"Penstemon centranthifolius\", # Scarlet bugler\n    species == \"GRICAM\" ~ \"Grindelia camporum\", # great valley gumweed\n    species == \"SALLEU\" ~ \"Salvia leucophylla\", # Purple sage\n    species == \"STIPUL\" ~ \"Nasella pulchra\", # Purple needlegrass\n    species == \"LOTSCO\" ~ \"Acmispon glaber\" # deerweed\n  )) %>% \n  relocate(species_name, .after = species) %>% # moving species_name column after species\n  mutate(water_treatment = case_when( # adding column with full treatment names\n    water == \"WW\" ~ \"Well watered\",\n    water == \"DS\" ~ \"Drought stressed\"\n  )) %>% \n  relocate(water_treatment, .after = water) # moving water_treatment column after water\n```\n:::\n\n\n# math\n\n## variance inflation factor\n\nThe VIF for the $j^{th}$ predictor is:\n\n$$\nVIF_j = \\frac{1}{1-R\n^2_j}\n$$\n\nwhere $R^2_J$ is the $R^2$ value obtained by a model with the $j^{th}$ predictor as a response and the rest of the predictors as predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggpairs(drought_exp_clean, # data frame\n        columns = c(\"leaf_dry_weight_g\", # columns to visualize\n                    \"sla\", \n                    \"shoot_g\", \n                    \"root_g\"), \n        upper = list(method = \"pearson\")) + # calculating Pearson correlation coefficient\n  theme_bw() + # cleaner theme\n  theme(panel.grid = element_blank()) # getting rid of gridlines\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n# VIF\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplant_model_all <- lm(total_g ~ leaf_dry_weight_g + sla + root_g + shoot_g,\n                      data = drought_exp_clean)\n\nvif(plant_model_all)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nleaf_dry_weight_g               sla            root_g           shoot_g \n         1.333854          1.351758          1.724823          1.645045 \n```\n\n\n:::\n\n```{.r .cell-code}\nplant_model_simple <- lm(total_g ~ leaf_dry_weight_g + sla + r_s,\n                         data = drought_exp_clean)\n\nvif(plant_model_simple)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nleaf_dry_weight_g               sla               r_s \n         1.049871          1.001752          1.049834 \n```\n\n\n:::\n\n```{.r .cell-code}\nmodel1 <- lm(total_g ~ sla + water_treatment + species,\n             data = drought_exp_clean)\n\nvif(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    GVIF Df GVIF^(1/(2*Df))\nsla             4.900028  1        2.213601\nwater_treatment 1.367759  1        1.169512\nspecies         4.532269  6        1.134209\n```\n\n\n:::\n:::\n\n\n# interaction terms\n\nusing a modified version of the frog toxicity model\n\n## no interaction\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrog_num <- 30\nset.seed(666)\nfrogs <- tibble(\n  weight = c(\n    round(rnorm(n = frog_num, mean = 5, sd = 0.35), 2),\n    round(rnorm(n = frog_num, mean = 5, sd = 0.35), 2)\n  ),\n  color = c(\n    rep(\"green\", frog_num),\n    rep(\"blue\", frog_num)\n  )\n) %>% \n  mutate(toxicity = case_when(\n    color == \"green\" ~ round(rnorm(n = frog_num, mean = 2, sd = 0.1), 2)*weight - 5,\n    color == \"blue\" ~ round(rnorm(n = frog_num, mean = 2, sd = 0.1), 2)*weight - 3\n  ))\n\nggplot(data = frogs,\n       aes(x = weight,\n           y = toxicity,\n           color = color)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfrog_mod <- lm(toxicity ~ weight + color,\n               data = frogs)\n\nsimulateResiduals(frog_mod) %>% plot()\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(frog_mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = toxicity ~ weight + color, data = frogs)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.38164 -0.30495  0.01705  0.32444  1.34105 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -1.8311     0.8863  -2.066   0.0434 *  \nweight        1.7407     0.1747   9.966 4.26e-14 ***\ncolorgreen   -1.9444     0.1311 -14.834  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4992 on 57 degrees of freedom\nMultiple R-squared:  0.8713,\tAdjusted R-squared:  0.8668 \nF-statistic: 192.9 on 2 and 57 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(frog_mod,\n          terms = c(\"weight [all]\",\n                    \"color\")) %>% \n  plot(show_data = TRUE, \n       limit_range = TRUE) +\n  scale_color_manual(values = c(\"green\" = \"darkgreen\", \n                                \"blue\" = \"blue\")) +\n  scale_fill_manual(values = c(\"green\" = \"darkgreen\", \n                                \"blue\" = \"blue\")) +\n  theme_classic() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n\n\n## with interaction\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\nfrogs <- tibble(\n  weight = c(\n    round(rnorm(n = frog_num, mean = 5, sd = 0.35), 2),\n    round(rnorm(n = frog_num, mean = 5, sd = 0.35), 2)\n  ),\n  color = c(\n    rep(\"green\", frog_num),\n    rep(\"blue\", frog_num)\n  )\n) %>% \n  mutate(toxicity = case_when(\n    color == \"green\" ~ round(rnorm(n = frog_num, mean = -2, sd = 0.1), 2)*weight + 15,\n    color == \"blue\" ~ round(rnorm(n = frog_num, mean = 2, sd = 0.1), 2)*weight - 7\n  ))\n\nggplot(data = frogs,\n       aes(x = weight,\n           y = toxicity,\n           color = color,\n           shape = color)) +\n  geom_point(size = 3,\n             alpha = 0.8) +\n  # scale_x_continuous(limits = c(0, 7)) +\n  scale_color_manual(values = c(\"green\" = \"darkgreen\", \n                                \"blue\" = \"blue\")) \n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfrog_mod1 <- lm(toxicity ~ weight + color, # no interaction\n               data = frogs)\n\nfrog_mod2 <- lm(toxicity ~ weight * color, # interaction\n               data = frogs)\n\nsimulateResiduals(frog_mod1) %>% plot() # no interaction\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\nsimulateResiduals(frog_mod2) %>% plot() # interaction\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(frog_mod1) # no interaction\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = toxicity ~ weight + color, data = frogs)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.78880 -0.67346 -0.02757  0.54386  2.35344 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   7.6209     1.5994   4.765 1.34e-05 ***\nweight       -0.9243     0.3152  -2.933  0.00483 ** \ncolorgreen    2.0470     0.2365   8.655 5.69e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9008 on 57 degrees of freedom\nMultiple R-squared:  0.6272,\tAdjusted R-squared:  0.6141 \nF-statistic: 47.94 on 2 and 57 DF,  p-value: 6.135e-13\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(frog_mod2) # interaction\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = toxicity ~ weight * color, data = frogs)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.36733 -0.31151  0.01057  0.35051  1.39586 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        -6.5225     1.5382  -4.240 8.44e-05 ***\nweight              1.8777     0.3042   6.172 7.96e-08 ***\ncolorgreen         23.0841     1.8689  12.352  < 2e-16 ***\nweight:colorgreen  -4.2056     0.3727 -11.285 4.78e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5023 on 56 degrees of freedom\nMultiple R-squared:  0.8861,\tAdjusted R-squared:   0.88 \nF-statistic: 145.3 on 3 and 56 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel.sel(frog_mod1, # no interaction\n          frog_mod2) # interaction\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel selection table \n           (Int) clr       wgh clr:wgh df  logLik  AICc delta\nfrog_mod2 -6.523   + 1.000e+00       +  5 -41.749  94.6  0.00\nfrog_mod1  7.621   + 1.162e-15          4 -77.329 163.4 68.78\nModels ranked by AICc(x) \n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(frog_mod2,\n          terms = c(\"weight [all]\",\n                    \"color\")) %>% \n  plot(show_data = TRUE, \n       limit_range = TRUE) +\n  scale_color_manual(values = c(\"green\" = \"darkgreen\", \n                                \"blue\" = \"blue\")) +\n  scale_fill_manual(values = c(\"green\" = \"darkgreen\", \n                                \"blue\" = \"blue\")) +\n  theme_classic() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n:::\n\n\ncalculating slopes (very hacky):\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredictions <- ggpredict(frog_mod2,\n          terms = c(\"weight [all]\",\n                    \"color\")) %>% \n  group_by(group) %>% \n  filter(predicted %in% c(max(predicted), min(predicted))) %>% \n  arrange(group)\n\npredictions\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 6\n# Groups:   group [2]\n      x predicted std.error conf.low conf.high group\n  <dbl>     <dbl>     <dbl>    <dbl>     <dbl> <fct>\n1  4.22      6.74     0.175    6.39       7.09 green\n2  5.75      3.18     0.203    2.77       3.58 green\n3  4.22      1.40     0.268    0.864      1.94 blue \n4  5.75      4.27     0.232    3.81       4.74 blue \n```\n\n\n:::\n\n```{.r .cell-code}\n# solve for slopes\ngreen_slope <- (pluck(predictions, 2, 2) - pluck(predictions, 2, 1))/(pluck(predictions, 1, 2) - pluck(predictions, 1, 1))\ngreen_slope\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -2.327946\n```\n\n\n:::\n\n```{.r .cell-code}\nblue_slope <- (pluck(predictions, 2, 4) - pluck(predictions, 2, 3))/(pluck(predictions, 1, 4) - pluck(predictions, 1, 3))\nblue_slope  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.877666\n```\n\n\n:::\n\n```{.r .cell-code}\n# solve for intercepts\ngreen_intercept <- pluck(predictions, 2, 2) - (green_slope*pluck(predictions, 1, 2))\ngreen_intercept\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16.56161\n```\n\n\n:::\n\n```{.r .cell-code}\nblue_intercept <- pluck(predictions, 2, 4) - (blue_slope*pluck(predictions, 1, 4))\nblue_intercept \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -6.522534\n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(frog_mod2,\n          terms = c(\"weight [5]\",\n                    \"color\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Predicted values of toxicity\n\ncolor: green\n\nweight | Predicted |     95% CI\n-------------------------------\n     5 |      4.92 | 4.73, 5.11\n\ncolor: blue\n\nweight | Predicted |     95% CI\n-------------------------------\n     5 |      2.87 | 2.68, 3.05\n```\n\n\n:::\n\n```{.r .cell-code}\ngreen_slope*5 + green_intercept\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4.921879\n```\n\n\n:::\n\n```{.r .cell-code}\nblue_slope*5 + blue_intercept\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.865798\n```\n\n\n:::\n:::\n\n\n\n# simpson's paradox\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbill_model <- lm(bill_length_mm ~ bill_depth_mm, data = penguins)\n\nsimulateResiduals(bill_model) %>% plot()\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(bill_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = bill_length_mm ~ bill_depth_mm, data = penguins)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-12.8949  -3.9042  -0.3772   3.6800  15.5798 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    55.0674     2.5160  21.887  < 2e-16 ***\nbill_depth_mm  -0.6498     0.1457  -4.459 1.12e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.314 on 340 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.05525,\tAdjusted R-squared:  0.05247 \nF-statistic: 19.88 on 1 and 340 DF,  p-value: 1.12e-05\n```\n\n\n:::\n\n```{.r .cell-code}\nconfint(bill_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   2.5 %     97.5 %\n(Intercept)   50.1185795 60.0161600\nbill_depth_mm -0.9364867 -0.3631844\n```\n\n\n:::\n\n```{.r .cell-code}\nbill_model_preds <- ggpredict(bill_model, terms = \"bill_depth_mm\")\n\nmodel_plot <- ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) +\n  geom_point() +\n  geom_line(data = bill_model_preds, aes(x = x, y = predicted), color = \"blue\", linewidth = 2) +\n  geom_ribbon(data = bill_model_preds, aes(x = x, y = predicted, ymin = conf.low, ymax = conf.high), alpha = 0.2) +\n  theme_classic() +\n  labs(x = \"Bill depth (mm)\", y = \"Bill length (mm)\")\n```\n:::\n\n\n$$\nlength = -0.65*depth + 55.07\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbill_model2 <- lm(bill_length_mm ~ bill_depth_mm*species, data = penguins)\npar(mfrow = c(2, 2))\nplot(bill_model2)\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-8-1.png){width=960}\n:::\n\n```{.r .cell-code}\nsummary(bill_model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = bill_length_mm ~ bill_depth_mm * species, data = penguins)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.7888 -1.5415  0.0575  1.5873 10.3590 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                     23.0681     3.0165   7.647 2.18e-13 ***\nbill_depth_mm                    0.8570     0.1641   5.224 3.08e-07 ***\nspeciesChinstrap                -9.6402     5.7154  -1.687 0.092590 .  \nspeciesGentoo                   -5.8386     4.5353  -1.287 0.198850    \nbill_depth_mm:speciesChinstrap   1.0651     0.3100   3.435 0.000666 ***\nbill_depth_mm:speciesGentoo      1.1637     0.2789   4.172 3.84e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.445 on 336 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.8024,\tAdjusted R-squared:  0.7995 \nF-statistic: 272.9 on 5 and 336 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nlrtest(bill_model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLikelihood ratio test\n\nModel 1: bill_length_mm ~ bill_depth_mm * species\nModel 2: bill_length_mm ~ 1\n  #Df   LogLik Df  Chisq Pr(>Chisq)    \n1   7  -787.97                         \n2   2 -1065.28 -5 554.62  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(bill_model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: bill_length_mm\n                       Df Sum Sq Mean Sq F value    Pr(>F)    \nbill_depth_mm           1  561.6   561.6  93.965 < 2.2e-16 ***\nspecies                 2 7460.3  3730.2 624.151 < 2.2e-16 ***\nbill_depth_mm:species   2  134.3    67.1  11.232 1.898e-05 ***\nResiduals             336 2008.1     6.0                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nwaldtest(bill_model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWald test\n\nModel 1: bill_length_mm ~ bill_depth_mm * species\nModel 2: bill_length_mm ~ 1\n  Res.Df Df      F    Pr(>F)    \n1    336                        \n2    341 -5 272.95 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nggpredict(bill_model2, \n          terms = c(\"bill_depth_mm [all]\", \n                    \"species\")) %>% \n  plot(show_data = TRUE, \n       limit_range = TRUE)\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-8-2.png){width=960}\n:::\n\n```{.r .cell-code}\npenguins %>% \n  group_by(species) %>% \n  summarize(min = min(bill_depth_mm, na.rm = TRUE),\n            max = max(bill_depth_mm, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  species     min   max\n  <fct>     <dbl> <dbl>\n1 Adelie     15.5  21.5\n2 Chinstrap  16.4  20.8\n3 Gentoo     13.1  17.3\n```\n\n\n:::\n\n```{.r .cell-code}\nbill_model2_preds <- ggpredict(bill_model2, \n                               terms = c(\"bill_depth_mm [13.1:21.5 by = 0.1]\", \n                                         \"species\")) %>% \n  as_tibble() %>% \n  rename(species = group) %>% \n  mutate(keep = case_when(\n    species == \"Adelie\" & between(x, 15.5, 21.5) ~ \"keep\",\n    species == \"Chinstrap\" & between(x, 16.4, 20.8) ~ \"keep\",\n    species == \"Gentoo\" & between(x, 13.1, 17.3) ~ \"keep\"\n  )) %>% \n  drop_na(keep) %>% \n  select(-keep)\n\nmodel2_plot <- ggplot(penguins, \n                      aes(x = bill_depth_mm, \n                          y = bill_length_mm)) +\n  geom_point(aes(color = species)) +\n  geom_line(data = bill_model2_preds, \n            aes(x = x, \n                y = predicted, \n                color = species), \n            linewidth = 2) +\n  geom_ribbon(data = bill_model2_preds, \n              aes(x = x, \n                  y = predicted, \n                  ymin = conf.low, \n                  ymax = conf.high, \n                  fill = species), \n              alpha = 0.2) +\n  scale_color_manual(values = c(\"cornflowerblue\", \"darkgreen\", \"darkorange\")) +\n  scale_fill_manual(values = c(\"cornflowerblue\", \"darkgreen\", \"darkorange\")) +\n  theme_classic() +\n  labs(x = \"Bill depth (mm)\", \n       y = \"Bill length (mm)\",\n       color = \"Species\", \n       fill = \"Species\") \n\nmodel_plot + model2_plot\n```\n\n::: {.cell-output-display}\n![](lecture_week-09_files/figure-html/unnamed-chunk-8-3.png){width=960}\n:::\n\n```{.r .cell-code}\nextract_eq(bill_model)\n```\n\n::: {.cell-output-display}\n$$\n\\operatorname{bill\\_length\\_mm} = \\alpha + \\beta_{1}(\\operatorname{bill\\_depth\\_mm}) + \\epsilon\n$$\n\n:::\n:::\n\n\n\n$$\n\\operatorname{bill\\_length\\_mm} = \\alpha + \\beta_{1}(\\operatorname{bill\\_depth\\_mm}) + \\beta_{2}(\\operatorname{species}_{\\operatorname{Chinstrap}}) + \\beta_{3}(\\operatorname{species}_{\\operatorname{Gentoo}}) + \\beta_{4}(\\operatorname{bill\\_depth\\_mm} \\times \\operatorname{species}_{\\operatorname{Chinstrap}}) + \\beta_{5}(\\operatorname{bill\\_depth\\_mm} \\times \\operatorname{species}_{\\operatorname{Gentoo}}) + \\epsilon\n$$\n\n$$\n\\operatorname{bill\\_length\\_mm} = \\alpha + \\beta_{1}(\\operatorname{bill\\_depth\\_mm}) + \\epsilon \n$$\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "lecture_week-09_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}