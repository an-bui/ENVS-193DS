{
  "hash": "bbc05b14e5eed61eb50eb16cf7027e94",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 10 figures - Lectures 17 and 18\"\neditor: source\nfreeze: auto\nexecute:\n  message: false\n  warning: false\nformat:\n  html: \n    code-fold: true\nauthor:\n  - name: An Bui\n    url: https://an-bui.com/\n    affiliation: UC Santa Barbara, Ecology, Evolution, and Marine Biology\n    affiliation-url: https://www.eemb.ucsb.edu/\npublished-title: \"Lecture date\"\ndate: 2024-06-03\ndate-modified: last-modified\ncategories: []\ncitation:\n  url: https://spring-2024.envs-193ds.com/lecture/lecture_week-10.html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# cleaning\nlibrary(tidyverse)\n\n# visualization\ntheme_set(theme_classic() +\n            theme(panel.grid = element_blank(),\n                  axis.text = element_text(size = 18),\n                  axis.title = element_text(size = 18),\n                  text = element_text(family = \"Lato\")))\nlibrary(patchwork)\nlibrary(ggeffects)\nlibrary(flextable)\nlibrary(GGally)\nlibrary(equatiomatic)\n\n# data\nlibrary(palmerpenguins)\n\n# analysis\nlibrary(car)\nlibrary(performance)\nlibrary(broom)\nlibrary(DHARMa)\nlibrary(MuMIn)\nlibrary(lmtest)\n```\n:::\n\n\n# math notation\n\n## simple linear regression\n\n$$\nE[y_i] = a + bx_i\n$$\n\n$$\nvar[y_i] = s^2\n$$\n\n## generalized form:\n\n$$\nE[y_i] = a + bx_i\n$$\n\n$$\nvar[y_i] = v(E[y_i])\n$$\n\n# GLM structure using Gaussian example\n\n## random component\n\n$$\nY_i \\sim N(\\mu_i, \\sigma^2)\n$$\n\n## systematic component\n\n$$\n\\eta_i = \\sum^{p-1}_{n = 0}\\beta_jx_{ij}\n$$\n\n## link\n\n$$\ng(\\mu_i) = \\eta_i\n$$\n\n# negative binomial example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\nnbinom_df <- bind_cols(\n  size1 = rnbinom(mu = 10, size = 1, n = 100),\n  size10 = rnbinom(mu = 10, size = 10, n = 100),\n  size100 = rnbinom(mu = 10, size = 100, n = 100)\n)\n\nggplot(data.frame(x = 1:20), aes(x)) +\n  stat_function(geom = \"point\", n = 20, fun = dnbinom, args = list(mu = 4, x = 5), size = 2) +\n  stat_function(geom = \"line\", n = 20, fun = dnbinom, args = list(mu = 4, x = 5))\n```\n\n::: {.cell-output-display}\n![](lecture_week-10_files/figure-html/nbinom-fig-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsize1 <- ggplot(nbinom_df, aes(x = size1)) +\n  geom_histogram(bins = 8, fill = \"cornflowerblue\", color = \"grey8\") +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 40)) +\n  theme_classic() +\n  labs(title = expression(mu~\"= 10, k = 1\")) +\n  theme(axis.title.x = element_blank())\n\nsize10 <- ggplot(nbinom_df, aes(x = size10)) +\n  geom_histogram(bins = 8, fill = \"cornflowerblue\", color = \"grey8\") +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 40)) +\n  theme_classic() +\n  labs(title = expression(mu~\"= 10, k = 10\")) +\n  theme(axis.title.x = element_blank())\n\nsize100 <- ggplot(nbinom_df, aes(x = size100)) +\n  geom_histogram(bins = 8, fill = \"cornflowerblue\", color = \"grey8\") +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 40)) +\n  theme_classic() +\n  labs(title = expression(mu~\"= 10, k = 100\")) +\n  theme(axis.title.x = element_blank())\n\nsize1 + size10 + size100\n```\n\n::: {.cell-output-display}\n![](lecture_week-10_files/figure-html/nbinom-fig-2.png){width=672}\n:::\n:::\n\n\n# poisson example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(666)\npois_df <- bind_cols(\n  lambda1 = rpois(lambda = 1, n = 100),\n  lambda5 = rpois(lambda = 5, n = 100),\n  lambda20 = rpois(lambda = 20, n = 100)\n)\n\nlambda1 <- ggplot(pois_df, aes(x = lambda1)) +\n  geom_histogram(bins = 8, fill = \"darkorange\", color = \"grey8\") +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 40)) +\n  theme_classic() +\n  labs(title = expression(lambda~\"= 1\")) +\n  theme(axis.title.x = element_blank())\n\nlambda5 <- ggplot(pois_df, aes(x = lambda5)) +\n  geom_histogram(bins = 8, fill = \"darkorange\", color = \"grey8\") +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 40)) +\n  theme_classic() +\n  labs(title = expression(lambda~\"= 5\")) +\n  theme(axis.title.x = element_blank())\n\nlambda20 <- ggplot(pois_df, aes(x = lambda20)) +\n  geom_histogram(bins = 8, fill = \"darkorange\", color = \"grey8\") +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 40)) +\n  theme_classic() +\n  labs(title = expression(lambda~\"= 20\")) +\n  theme(axis.title.x = element_blank())\n\nlambda1 + lambda5 + lambda20\n```\n\n::: {.cell-output-display}\n![](lecture_week-10_files/figure-html/pois-fig-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "lecture_week-10_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}