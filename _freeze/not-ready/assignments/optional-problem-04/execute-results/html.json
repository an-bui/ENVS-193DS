{
  "hash": "0a7b434e50b534ac4d5b54af6c4a169b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"OPTIONAL practice problem - Do a Wilcoxon signed rank test by hand\"\neditor: source\nfreeze: auto\ndate: 2024-05-01\ndate-modified: last-modified\n---\n\n::: {.cell}\n\n:::\n\n\n## 1. Description\n\nIn this practice problem, you'll do a Wilcoxon signed rank test comparing paired samples to each other by hand, then double check your work with R. This is the non-parametric version of the paired t-test.  \n\n## 2. Steps\n\n### a. Values\n\nStart with these values:  \n\n:::: {.columns}\n::: {.column width=\"40%\"}\n\n| Before | After |\n|:------:|:-----:|\n| 1.2    | 1.6   |\n| 2.0    | 2.8   |\n| 0.8    | 0.7   |\n| 0.6    | 0.6   |\n| 1.3    | 1.5   |\n| 3.2    | 2.7   |\n| 0.9    | 1.1   |\n\n:::\n::::\n\n### b. Calculate the differences between samples\n\nThen, calculate the differences between those values. You should get something that looks like this:\n\n:::: {.columns}\n::: {.column width=\"40%\"}\n\n| Differences    |\n|:--------------:|\n| -0.4           |\n| -0.8           |\n| 0.1            |\n| 0.0            |\n| -0.2           |\n| 0.5            |\n| -0.2           |\n\n:::\n::::\n\n### c. Take out 0, arrange by magnitude\n\nThen, omit all observations of 0 and arrange your numbers by magnitude. You should get something that looks like this:\n\n:::: {.columns}\n::: {.column width=\"40%\"}\n\n| Ordered magnitude    |\n|:--------------------:|\n| 0.1                  |\n| -0.2                 |\n| -0.2                 |\n| -0.4                 |\n| 0.5                  |\n| -0.8                 |\n\n:::\n::::\n\n### d. Give each value a \"sign\" and a \"rank\"\n\nThis is the \"signed rank\" part of the test: assign each value a sign (+ or -), then rank (1, 2, 3, 4, etc.) You should get something that looks like this:\n\n:::: {.columns}\n::: {.column width=\"40%\"}\n\n| Ordered magnitude    |   Signed rank        |\n|:--------------------:|:--------------------:|\n| 0.1                  |      + 1             |\n| -0.2                 |      - 2             |\n| -0.2                 |      - 2             |\n| -0.4                 |      - 4             |\n| 0.5                  |      + 5             |\n| -0.8                 |      - 6             |\n\n:::\n::::\n\n### e. Sum the magnitudes of the + and - values\n\nSum the magnitudes of the + and - values. This will be the -W and +W statistic. You then choose the lower statistic.\n\nIn this case, you should get:  \n\n+W = 1 + 5 = 6  \n-W = 2 + 2 + 4 + 6 = 14  \n\nPick the lowest one: +W = 6.  \n\n### e. Run the test in R to check your work.\n\nStart with this data frame:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# creating a long format data frame\ndf <- tibble(before = c(1.2, 2.0, 0.8, 0.6, 1.3, 3.2, 0.9), # original values\n             after = c(1.6, 2.8, 0.7, 0.6, 1.5, 2.7, 1.1)) %>% \n  pivot_longer(cols = before:after, # making this long format\n               names_to = \"sample\", # creating a column called \"sample\" that has before and after\n               values_to = \"value\") %>% # creating a column called value that has the values\n  mutate(sample = fct_relevel(sample, \"before\", \"after\")) %>% # making sure that before appears in the data frame first\n  arrange(sample) # arranging the data frame so that before and after are all sitting \n```\n:::\n\n\nThen run a Wilcoxon signed rank test (note the `paired = TRUE` argument).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(value ~ sample, # formula\n            data = df, # data\n            paired = TRUE) # argument for a paired test\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot\ncompute exact p-value with zeroes\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  value by sample\nV = 6, p-value = 0.4017\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n### f. Try a one-sample test.\n\nCompare the following values to $\\mu = 7$:\n\n:::: {.columns}\n::: {.column width=\"40%\"}\n\n| Sample |\n|:------:|\n| 2.8    |\n| 8.3    |\n| 4.5    |\n| 6.7    |\n| 8.1    |\n| 7.2    |\n| 7.8    |\n\n:::\n::::\n\n\nFirst, calculate the difference between each observation and the $\\mu$, which is 7:\n\n:::: {.columns}\n::: {.column width=\"40%\"}\n\n| Sample |  Difference  |\n|:------:|:------------:|\n| 2.8    |  -4.2        |\n| 8.3    |  1.3         |\n| 4.5    |  -2.5        |\n| 6.7    |  -0.3        |\n| 8.1    |  1.1         |\n| 7.2    |  0.2         |\n| 7.8    |  0.8         |\n\n:::\n::::\n\n\nThen order each difference and assign a sign and rank:\n\n:::: {.columns}\n::: {.column width=\"40%\"}\n\n| Ordered magnitude    |   Signed rank        |\n|:--------------------:|:--------------------:|\n| 0.2                  |      + 1             |\n| -0.3                 |      - 2             |\n| 0.8                  |      + 3             |\n| 1.1                  |      + 4             |\n| 1.3                  |      + 5             |\n| -2.5                 |      - 6             |\n| -4.2                 |      - 7             |\n\n:::\n::::\n\n\nThen sum the magnitudes:  \n\n+W = 1 + 3 + 4 + 5 = 13   \n-W = 2 + 6 + 7 = 15  \n\nFor this example, W = 13.  \n\nThen, double check your work in R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(c(2.8, 8.3, 4.5, 6.7, 8.1, 7.2, 7.8),\n            mu = 7)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  c(2.8, 8.3, 4.5, 6.7, 8.1, 7.2, 7.8)\nV = 13, p-value = 0.9375\nalternative hypothesis: true location is not equal to 7\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}